var Ge=Object.defineProperty,Qe=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var Be=(e,t,n)=>t in e?Ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,H=(e,t)=>{for(var n in t||(t={}))Ee.call(t,n)&&Be(e,n,t[n]);if(he)for(var n of he(t))je.call(t,n)&&Be(e,n,t[n]);return e},me=(e,t)=>Qe(e,Ke(t));var Me=(e,t)=>{var n={};for(var c in e)Ee.call(e,c)&&t.indexOf(c)<0&&(n[c]=e[c]);if(e!=null&&he)for(var c of he(e))t.indexOf(c)<0&&je.call(e,c)&&(n[c]=e[c]);return n};import{R as $e,r as i,j as v,a as Ve,b as Ze}from"./vendor.44b7eecb.js";const et=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&c(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}};et();var j;(function(e){e[e.Edit=0]="Edit",e[e.Source=1]="Source"})(j||(j={}));function pe({image:e,width:t,height:n,history:c,bounds:s}){return new Promise((r,o)=>{const a=document.createElement("canvas"),m=s.width*window.devicePixelRatio,p=s.height*window.devicePixelRatio;a.width=m,a.height=p;const l=a.getContext("2d");if(!l)return o(new Error("convert image to blob fail"));const u=e.naturalWidth/t,h=e.naturalHeight/n;l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="low",l.setTransform(window.devicePixelRatio,0,0,window.devicePixelRatio,0,0),l.clearRect(0,0,s.width,s.height),l.drawImage(e,s.x*u,s.y*h,s.width*u,s.height*h,0,0,s.width,s.height),c.stack.slice(0,c.index+1).forEach(f=>{f.type===j.Source&&f.draw(l,f)}),a.toBlob(f=>{if(!f)return o(new Error("canvas toBlob fail"));r(f)},"image/png")})}const _e={magnifier_position_label:"\u5750\u6807",operation_ok_title:"\u786E\u5B9A",operation_cancel_title:"\u53D6\u6D88",operation_save_title:"\u4FDD\u5B58",operation_redo_title:"\u91CD\u505A",operation_undo_title:"\u64A4\u9500",operation_mosaic_title:"\u9A6C\u8D5B\u514B",operation_text_title:"\u6587\u672C",operation_brush_title:"\u753B\u7B14",operation_arrow_title:"\u7BAD\u5934",operation_ellipse_title:"\u692D\u5706",operation_rectangle_title:"\u77E9\u5F62"};var ye=$e.createContext({store:{url:void 0,image:null,width:0,height:0,lang:_e,emiterRef:{current:{}},canvasContextRef:{current:null},history:{index:-1,stack:[]},bounds:null,cursor:"move",operation:void 0},dispatcher:{call:void 0,setHistory:void 0,setBounds:void 0,setCursor:void 0,setOperation:void 0}});function ce(){const{dispatcher:e}=i.exports.useContext(ye);return e}function V(){const{store:e}=i.exports.useContext(ye);return e}function G(){const{bounds:e}=V(),{setBounds:t}=ce(),n=i.exports.useCallback(s=>{t==null||t(s)},[t]),c=i.exports.useCallback(()=>{t==null||t(null)},[t]);return[e,{set:n,reset:c}]}function Y(){const{lang:e}=V();return e}var Q="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsMagnifier/index.tsx";const K=100,Z=80;var tt=i.exports.memo(function({x:t,y:n}){const{width:c,height:s,image:r}=V(),o=Y(),[a,m]=i.exports.useState(null),p=i.exports.useRef(null),l=i.exports.useRef(null),u=i.exports.useRef(null),[h,f]=i.exports.useState("000000");return i.exports.useLayoutEffect(()=>{if(!p.current)return;const d=p.current.getBoundingClientRect();let N=t+20,C=n+20;N+d.width>c&&(N=t-d.width-20),C+d.height>s&&(C=n-d.height-20),N<0&&(N=0),C<0&&(C=0),m({x:N,y:C})},[c,s,t,n]),i.exports.useEffect(()=>{if(!r||!l.current){u.current=null;return}if(u.current||(u.current=l.current.getContext("2d")),!u.current)return;const d=u.current;d.clearRect(0,0,K,Z);const N=r.naturalWidth/c,C=r.naturalHeight/s;d.drawImage(r,t*N-K/2,n*C-Z/2,K,Z,0,0,K,Z);const{data:y}=d.getImageData(Math.floor(K/2),Math.floor(Z/2),1,1),S=Array.from(y.slice(0,3)).map(D=>D>=16?D.toString(16):`0${D.toString(16)}`).join("").toUpperCase();f(S)},[c,s,r,t,n]),v.exports.jsxDEV("div",{ref:p,className:"screenshots-magnifier",style:{transform:`translate(${a==null?void 0:a.x}px, ${a==null?void 0:a.y}px)`},children:[v.exports.jsxDEV("div",{className:"screenshots-magnifier-body",children:v.exports.jsxDEV("canvas",{ref:l,className:"screenshots-magnifier-body-canvas",width:K,height:Z},void 0,!1,{fileName:Q,lineNumber:97,columnNumber:9},this)},void 0,!1,{fileName:Q,lineNumber:96,columnNumber:7},this),v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer",children:[v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer-item",children:[o.magnifier_position_label,": (",t,",",n,")"]},void 0,!0,{fileName:Q,lineNumber:105,columnNumber:9},this),v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer-item",children:["RGB: #",h]},void 0,!0,{fileName:Q,lineNumber:108,columnNumber:9},this)]},void 0,!0,{fileName:Q,lineNumber:104,columnNumber:7},this)]},void 0,!0,{fileName:Q,lineNumber:89,columnNumber:5},this)});function st({x:e,y:t},{x:n,y:c},s,r){return e>n&&([e,n]=[n,e]),t>c&&([t,c]=[c,t]),e<0&&(e=0),n>s&&(n=s),t<0&&(t=0),c>r&&(c=r),{x:e,y:t,width:n-e,height:c-t}}var xe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsBackground/index.tsx",rt=i.exports.memo(function(){const{url:t,image:n,width:c,height:s}=V(),[r,o]=G(),a=i.exports.useRef(null),m=i.exports.useRef(null),p=i.exports.useRef(!1),[l,u]=i.exports.useState(null),h=i.exports.useCallback((d,N)=>{if(!a.current)return;const{x:C,y}=a.current.getBoundingClientRect();o.set(st({x:d.x-C,y:d.y-y},{x:N.x-C,y:N.y-y},c,s))},[c,s,o]),f=i.exports.useCallback(d=>{m.current||r||d.button!==0||(m.current={x:d.clientX,y:d.clientY},p.current=!1)},[r]);return i.exports.useEffect(()=>{const d=C=>{if(a.current){const y=a.current.getBoundingClientRect();C.clientX<y.left||C.clientY<y.top||C.clientX>y.right||C.clientY>y.bottom?u(null):u({x:C.clientX-y.x,y:C.clientY-y.y})}!m.current||(h(m.current,{x:C.clientX,y:C.clientY}),p.current=!0)},N=C=>{!m.current||(p.current&&h(m.current,{x:C.clientX,y:C.clientY}),m.current=null,p.current=!1)};return window.addEventListener("mousemove",d),window.addEventListener("mouseup",N),()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",N)}},[h]),i.exports.useLayoutEffect(()=>{(!n||r)&&u(null)},[n,r]),!t||!n?null:v.exports.jsxDEV("div",{ref:a,className:"screenshots-background",onMouseDown:f,children:[v.exports.jsxDEV("img",{className:"screenshots-background-image",src:t},void 0,!1,{fileName:xe,lineNumber:121,columnNumber:7},this),v.exports.jsxDEV("div",{className:"screenshots-background-mask"},void 0,!1,{fileName:xe,lineNumber:122,columnNumber:7},this),l&&!r&&v.exports.jsxDEV(tt,{x:l==null?void 0:l.x,y:l==null?void 0:l.y},void 0,!1,{fileName:xe,lineNumber:123,columnNumber:31},this)]},void 0,!0,{fileName:xe,lineNumber:120,columnNumber:5},this)});function O(){const{cursor:e}=V(),{setCursor:t}=ce(),n=i.exports.useCallback(s=>{t==null||t(s)},[t]),c=i.exports.useCallback(()=>{t==null||t("move")},[t]);return[e,{set:n,reset:c}]}function ee(){const{emiterRef:e}=V(),t=i.exports.useCallback((r,o)=>{const a=e.current;Array.isArray(a[r])?a[r].push(o):a[r]=[o]},[e]),n=i.exports.useCallback((r,o)=>{const a=e.current;if(Array.isArray(a[r])){const m=a[r].findIndex(p=>p===o);m!==-1&&a[r].splice(m,1)}},[e]),c=i.exports.useCallback((r,...o)=>{const a=e.current;Array.isArray(a[r])&&a[r].forEach(m=>m(...o))},[e]),s=i.exports.useCallback(()=>{e.current={}},[e]);return{on:t,off:n,emit:c,reset:s}}function L(){const{history:e}=V(),{setHistory:t}=ce(),n=i.exports.useCallback(l=>{const{index:u,stack:h}=e;h.forEach(f=>{f.type===j.Source&&(f.isSelected=!1)}),l.type===j.Source?l.isSelected=!0:l.type===j.Edit&&(l.source.isSelected=!0),h.splice(u+1),h.push(l),t==null||t({index:h.length-1,stack:h})},[e,t]),c=i.exports.useCallback(()=>{const{stack:l}=e;l.pop(),t==null||t({index:l.length-1,stack:l})},[e,t]),s=i.exports.useCallback(()=>{const{index:l,stack:u}=e,h=u[l];h&&(h.type===j.Source?h.isSelected=!1:h.type===j.Edit&&h.source.editHistory.pop()),t==null||t({index:l<=0?-1:l-1,stack:u})},[e,t]),r=i.exports.useCallback(()=>{const{index:l,stack:u}=e,h=u[l+1];h&&(h.type===j.Source?h.isSelected=!1:h.type===j.Edit&&h.source.editHistory.push(h)),t==null||t({index:l>=u.length-1?u.length-1:l+1,stack:u})},[e,t]),o=i.exports.useCallback(l=>{t==null||t(H({},l))},[t]),a=i.exports.useCallback(l=>{e.stack.forEach(u=>{u.type===j.Source&&(u===l?u.isSelected=!0:u.isSelected=!1)}),t==null||t(H({},e))},[e,t]),m=i.exports.useCallback(()=>{e.stack.forEach(l=>{l.type===j.Source&&(l.isSelected=!1)}),t==null||t(H({},e))},[e,t]),p=i.exports.useCallback(()=>{t==null||t({index:-1,stack:[]})},[t]);return[{index:e.index,stack:e.stack,top:e.stack.slice(e.index,e.index+1)[0]},{push:n,pop:c,undo:s,redo:r,set:o,select:a,clearSelect:m,reset:p}]}function I(){const{operation:e}=V(),{setOperation:t}=ce(),n=i.exports.useCallback(s=>{t==null||t(s)},[t]),c=i.exports.useCallback(()=>{t==null||t(void 0)},[t]);return[e,{set:n,reset:c}]}function nt({x:e,y:t},{x:n,y:c},s,r,o,a){return e>n&&([e,n]=[n,e]),t>c&&([t,c]=[c,t]),e<0&&(e=0,a==="move"&&(n=s.width)),n>r&&(n=r,a==="move"&&(e=n-s.width)),t<0&&(t=0,a==="move"&&(c=s.height)),c>o&&(c=o,a==="move"&&(t=c-s.height)),{x:e,y:t,width:Math.max(n-e,1),height:Math.max(c-t,1)}}function ot(e,t,n,c){const s=e.clientX-n.x,r=e.clientY-n.y;let o=c.x,a=c.y,m=c.x+c.width,p=c.y+c.height;switch(t){case"top":a+=r;break;case"top-right":m+=s,a+=r;break;case"right":m+=s;break;case"right-bottom":m+=s,p+=r;break;case"bottom":p+=r;break;case"bottom-left":o+=s,p+=r;break;case"left":o+=s;break;case"left-top":o+=s,a+=r;break;case"move":o+=s,a+=r,m+=s,p+=r;break}return[{x:o,y:a},{x:m,y:p}]}function ct(e,t,n,c){if(!t)return!1;const s=document.createElement("canvas");s.width=e.width,s.height=e.height;const r=s.getContext("2d");if(!r)return!1;const{left:o,top:a}=t.getBoundingClientRect(),m=c.clientX-o,p=c.clientY-a;return[...n.stack.slice(0,n.index+1)].reverse().find(u=>{var h;return u.type!==j.Source?!1:(r.clearRect(0,0,e.width,e.height),(h=u.isHit)==null?void 0:h.call(u,r,u,{x:m,y:p}))})}var J="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsCanvas/index.tsx";const it=["top","right","bottom","left"];var T;(function(e){e.ResizeTop="top",e.ResizetopRight="top-right",e.ResizeRight="right",e.ResizeRightBottom="right-bottom",e.ResizeBottom="bottom",e.ResizeBottomLeft="bottom-left",e.ResizeLeft="left",e.ResizeLeftTop="left-top",e.Move="move"})(T||(T={}));const at=[T.ResizeTop,T.ResizetopRight,T.ResizeRight,T.ResizeRightBottom,T.ResizeBottom,T.ResizeBottomLeft,T.ResizeLeft,T.ResizeLeftTop];var lt=i.exports.memo(i.exports.forwardRef(function(t,n){const{url:c,image:s,width:r,height:o}=V(),a=ee(),[m]=L(),[p]=O(),[l,u]=G(),[h]=I(),f=i.exports.useRef(),d=i.exports.useRef(null),N=i.exports.useRef(null),C=i.exports.useRef(null),y=i.exports.useRef(null),S=i.exports.useCallback(()=>{if(!l||!y.current)return;const x=y.current;x.imageSmoothingEnabled=!0,x.imageSmoothingQuality="low",x.clearRect(0,0,l.width,l.height),m.stack.slice(0,m.index+1).forEach(b=>{b.type===j.Source&&b.draw(x,b)})},[l,y,m]),D=i.exports.useCallback((x,b)=>{if(!(x.button!==0||!l))if(!h)f.current=b,d.current={x:x.clientX,y:x.clientY},N.current={x:l.x,y:l.y,width:l.width,height:l.height};else{const k=ct(l,C.current,m,x.nativeEvent);k?a.emit("drawselect",k,x.nativeEvent):a.emit("mousedown",x.nativeEvent)}},[l,h,a,m]),g=i.exports.useCallback(x=>{if(!f.current||!d.current||!N.current||!l)return;const b=ot(x,f.current,d.current,N.current);u.set(nt(b[0],b[1],l,r,o,f.current))},[r,o,l,u]);return i.exports.useLayoutEffect(()=>{if(!s||!l||!C.current){y.current=null;return}y.current||(y.current=C.current.getContext("2d")),S()},[s,l,S]),i.exports.useEffect(()=>{const x=k=>{if(h)a.emit("mousemove",k);else{if(!f.current||!d.current||!N.current)return;g(k)}},b=k=>{if(h)a.emit("mouseup",k);else{if(!f.current||!d.current||!N.current)return;g(k),f.current=void 0,d.current=null,N.current=null}};return window.addEventListener("mousemove",x),window.addEventListener("mouseup",b),()=>{window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",b)}},[g,h,a]),i.exports.useImperativeHandle(n,()=>y.current),v.exports.jsxDEV("div",{className:"screenshots-canvas",style:{width:(l==null?void 0:l.width)||0,height:(l==null?void 0:l.height)||0,transform:l?`translate(${l.x}px, ${l.y}px)`:"none"},children:[v.exports.jsxDEV("div",{className:"screenshots-canvas-body",children:[v.exports.jsxDEV("img",{className:"screenshots-canvas-image",src:c,style:{width:r,height:o,transform:l?`translate(${-l.x}px, ${-l.y}px)`:"none"}},void 0,!1,{fileName:J,lineNumber:183,columnNumber:11},this),v.exports.jsxDEV("canvas",{ref:C,className:"screenshots-canvas-panel",width:(l==null?void 0:l.width)||0,height:(l==null?void 0:l.height)||0},void 0,!1,{fileName:J,lineNumber:192,columnNumber:11},this)]},void 0,!0,{fileName:J,lineNumber:181,columnNumber:9},this),v.exports.jsxDEV("div",{className:"screenshots-canvas-mask",style:{cursor:p},onMouseDown:x=>D(x,"move")},void 0,!1,{fileName:J,lineNumber:199,columnNumber:9},this),it.map(x=>v.exports.jsxDEV("div",{className:`screenshots-canvas-border-${x}`},x,!1,{fileName:J,lineNumber:207,columnNumber:18},this)),at.map(x=>v.exports.jsxDEV("div",{className:`screenshots-canvas-point-${x}`,onMouseDown:b=>D(b,x)},x,!1,{fileName:J,lineNumber:211,columnNumber:13},this))]},void 0,!0,{fileName:J,lineNumber:173,columnNumber:7},this)}));function Ne(){const e=ce();return i.exports.useCallback((n,...c)=>{var s;(s=e.call)==null||s.call(e,n,...c)},[e])}function W(){const{canvasContextRef:e}=V();return e}function ke(){const e=ee(),[,t]=G(),[,n]=O(),[,c]=L(),[,s]=I();return i.exports.useCallback(()=>{e.reset(),c.reset(),t.reset(),n.reset(),s.reset()},[e,c,t,n,s])}var Ce="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsOption/index.tsx",q;(function(e){e.Bottom="bottom",e.Top="top"})(q||(q={}));var ut=i.exports.memo(function({open:t,content:n,children:c}){var N,C;const s=i.exports.useRef(null),r=i.exports.useRef(null),o=i.exports.useRef(null),a=i.exports.useContext(Ue),[m,p]=i.exports.useState(q.Bottom),[l,u]=i.exports.useState(null),[h,f]=i.exports.useState(0),d=()=>(r.current||(r.current=document.createElement("div")),r.current);return i.exports.useEffect(()=>{const y=d();return t&&document.body.appendChild(y),()=>{y.remove()}},[t]),i.exports.useEffect(()=>{if(!t||!a||!s.current||!o.current)return;const y=s.current.getBoundingClientRect(),S=o.current.getBoundingClientRect();let D=m,g=y.left+y.width/2,x=y.top+y.height,b=h;if(g+S.width/2>a.x+a.width){const k=g;g=a.x+a.width-S.width/2,b=k-g}if(g<a.x+S.width/2){const k=g;g=a.x+S.width/2,b=k-g}x>window.innerHeight-S.height&&(D===q.Bottom&&(D=q.Top),x=y.top-S.height),x<0&&(D===q.Top&&(D=q.Bottom),x=y.top+y.height),D!==m&&p(D),((l==null?void 0:l.x)!==g||l.y!==x)&&u({x:g,y:x}),b!==h&&f(b)}),v.exports.jsxDEV(v.exports.Fragment,{children:[i.exports.cloneElement(c,{ref:s}),t&&n&&Ve.exports.createPortal(v.exports.jsxDEV("div",{ref:o,className:"screenshots-option",style:{visibility:l?"visible":"hidden",transform:`translate(${(N=l==null?void 0:l.x)!=null?N:0}px, ${(C=l==null?void 0:l.y)!=null?C:0}px)`},"data-placement":m,children:[v.exports.jsxDEV("div",{className:"screenshots-option-container",children:n},void 0,!1,{fileName:Ce,lineNumber:120,columnNumber:13},this),v.exports.jsxDEV("div",{className:"screenshots-option-arrow",style:{marginLeft:h}},void 0,!1,{fileName:Ce,lineNumber:121,columnNumber:13},this)]},void 0,!0,{fileName:Ce,lineNumber:111,columnNumber:11},this),d())]},void 0,!0)});var Re="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsButton/index.tsx",X=i.exports.memo(function({title:t,icon:n,checked:c,disabled:s,option:r,onClick:o}){const a=["screenshots-button"],m=i.exports.useCallback(p=>{s||!o||o(p)},[s,o]);return c&&a.push("screenshots-button-checked"),s&&a.push("screenshots-button-disabled"),v.exports.jsxDEV(ut,{open:c,content:r,children:v.exports.jsxDEV("div",{className:a.join(" "),title:t,onClick:m,children:v.exports.jsxDEV("span",{className:n},void 0,!1,{fileName:Re,lineNumber:44,columnNumber:9},this)},void 0,!1,{fileName:Re,lineNumber:43,columnNumber:7},this)},void 0,!1,{fileName:Re,lineNumber:42,columnNumber:5},this)}),ft="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Ok/index.tsx";function ht(){const{image:e,width:t,height:n,history:c,bounds:s,lang:r}=V(),o=W(),[,a]=L(),m=Ne(),p=ke(),l=i.exports.useCallback(()=>{a.clearSelect(),setTimeout(()=>{!o.current||!e||!s||pe({image:e,width:t,height:n,history:c,bounds:s}).then(u=>{m("onOk",u,s),p()})})},[o,a,e,t,n,c,s,m,p]);return v.exports.jsxDEV(X,{title:r.operation_ok_title,icon:"icon-ok",onClick:l},void 0,!1,{fileName:ft,lineNumber:36,columnNumber:10},this)}var mt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Cancel/index.tsx";function pt(){const e=Ne(),t=ke(),n=Y(),c=i.exports.useCallback(()=>{e("onCancel"),t()},[e,t]);return v.exports.jsxDEV(X,{title:n.operation_cancel_title,icon:"icon-cancel",onClick:c},void 0,!1,{fileName:mt,lineNumber:17,columnNumber:10},this)}var xt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Save/index.tsx";function dt(){const{image:e,width:t,height:n,history:c,bounds:s,lang:r}=V(),o=W(),[,a]=L(),m=Ne(),p=ke(),l=i.exports.useCallback(()=>{a.clearSelect(),setTimeout(()=>{!o.current||!e||!s||pe({image:e,width:t,height:n,history:c,bounds:s}).then(u=>{m("onSave",u,s),p()})})},[o,a,e,t,n,c,s,m,p]);return v.exports.jsxDEV(X,{title:r.operation_save_title,icon:"icon-save",onClick:l},void 0,!1,{fileName:xt,lineNumber:36,columnNumber:10},this)}var gt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Redo/index.tsx";function vt(){const e=Y(),[t,n]=L(),c=i.exports.useCallback(()=>{n.redo()},[n]);return v.exports.jsxDEV(X,{title:e.operation_redo_title,icon:"icon-redo",disabled:!t.stack.length||t.stack.length-1===t.index,onClick:c},void 0,!1,{fileName:gt,lineNumber:15,columnNumber:5},this)}var bt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Undo/index.tsx";function yt(){const e=Y(),[t,n]=L(),c=i.exports.useCallback(()=>{n.undo()},[n]);return v.exports.jsxDEV(X,{title:e.operation_undo_title,icon:"icon-undo",disabled:t.index===-1,onClick:c},void 0,!1,{fileName:bt,lineNumber:15,columnNumber:5},this)}var Se="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsSize/index.tsx",Le=i.exports.memo(function({value:t,onChange:n}){const c=[3,6,9];return v.exports.jsxDEV("div",{className:"screenshots-size",children:c.map(s=>{const r=["screenshots-size-item"];return s===t&&r.push("screenshots-size-active"),v.exports.jsxDEV("div",{className:r.join(" "),onClick:()=>n&&n(s),children:v.exports.jsxDEV("div",{className:"screenshots-size-pointer",style:{width:s*1.8,height:s*1.8}},void 0,!1,{fileName:Se,lineNumber:22,columnNumber:13},this)},s,!1,{fileName:Se,lineNumber:21,columnNumber:11},this)})},void 0,!1,{fileName:Se,lineNumber:12,columnNumber:5},this)});function te(e){const t=ee();i.exports.useEffect(()=>(t.on("mousedown",e),()=>{t.off("mousedown",e)}),[e,t])}function se(e){const t=ee();i.exports.useEffect(()=>(t.on("mousemove",e),()=>{t.off("mousemove",e)}),[e,t])}function re(e){const t=ee();i.exports.useEffect(()=>(t.on("mouseup",e),()=>{t.off("mouseup",e)}),[e,t])}var Xe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Mosaic/index.tsx";function de(e,t,n){if(!n)return[0,0,0,0];const{data:c,width:s}=n,r=t*s*4+e*4;return Array.from(c.slice(r,r+4))}function Nt(e,t){const{tiles:n,size:c}=t.data;n.forEach(s=>{const r=Math.round(s.color[0]),o=Math.round(s.color[1]),a=Math.round(s.color[2]),m=s.color[3]/255;e.fillStyle=`rgba(${r}, ${o}, ${a}, ${m})`,e.fillRect(s.x-c/2,s.y-c/2,c,c)})}function kt(){const e=Y(),{image:t,width:n,height:c}=V(),[s,r]=I(),o=W(),[a,m]=L(),[p]=G(),[,l]=O(),[u,h]=i.exports.useState(3),f=i.exports.useRef(null),d=i.exports.useRef(null),N=s==="Mosaic",C=i.exports.useCallback(()=>{r.set("Mosaic"),l.set("crosshair")},[r,l]),y=i.exports.useCallback(()=>{N||(C(),m.clearSelect())},[N,C,m]),S=i.exports.useCallback(x=>{if(!N||d.current||!f.current||!o.current)return;const b=o.current.canvas.getBoundingClientRect(),k=x.clientX-b.x,w=x.clientY-b.y,E=u*2;d.current={name:"Mosaic",type:j.Source,data:{size:E,tiles:[{x:k,y:w,color:de(k,w,f.current)}]},editHistory:[],draw:Nt}},[N,u,o]),D=i.exports.useCallback(x=>{if(!N||!d.current||!o.current||!f.current)return;const b=o.current.canvas.getBoundingClientRect(),k=x.clientX-b.x,w=x.clientY-b.y,E=d.current.data.size,z=d.current.data.tiles;let R=z[z.length-1];if(!R)z.push({x:k,y:w,color:de(k,w,f.current)});else{const A=R.x-k,B=R.y-w;let _=Math.sqrt(A**2+B**2);const ve=-B/_,be=-A/_;for(;_>E;){const ne=Math.floor(R.x+E*be),oe=Math.floor(R.y+E*ve);R={x:ne,y:oe,color:de(ne,oe,f.current)},z.push(R),_-=E}_>E/2&&z.push({x:k,y:w,color:de(k,w,f.current)})}a.top!==d.current?m.push(d.current):m.set(a)},[N,o,a,m]),g=i.exports.useCallback(()=>{!N||(d.current=null)},[N]);return te(S),se(D),re(g),i.exports.useEffect(()=>{if(!p||!t||!N)return;const x=document.createElement("canvas"),b=x.getContext("2d");if(!b)return;x.width=p.width,x.height=p.height;const k=t.naturalWidth/n,w=t.naturalHeight/c;b.drawImage(t,p.x*k,p.y*w,p.width*k,p.height*w,0,0,p.width,p.height),f.current=b.getImageData(0,0,p.width,p.height)},[n,c,p,t,N]),v.exports.jsxDEV(X,{title:e.operation_mosaic_title,icon:"icon-mosaic",checked:N,onClick:y,option:v.exports.jsxDEV(Le,{value:u,onChange:h},void 0,!1,{fileName:Xe,lineNumber:220,columnNumber:15},this)},void 0,!1,{fileName:Xe,lineNumber:215,columnNumber:5},this)}var Pe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsColor/index.tsx",Ct=i.exports.memo(function({value:t,onChange:n}){const c=["#ee5126","#fceb4d","#90e746","#51c0fa","#7a7a7a","#ffffff"];return v.exports.jsxDEV("div",{className:"screenshots-color",children:c.map(s=>{const r=["screenshots-color-item"];return s===t&&r.push("screenshots-color-active"),v.exports.jsxDEV("div",{className:r.join(" "),style:{backgroundColor:s},onClick:()=>n&&n(s)},s,!1,{fileName:Pe,lineNumber:19,columnNumber:11},this)})},void 0,!1,{fileName:Pe,lineNumber:12,columnNumber:5},this)});var we="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsSizeColor/index.tsx",ie=i.exports.memo(function({size:t,color:n,onSizeChange:c,onColorChange:s}){return v.exports.jsxDEV("div",{className:"screenshots-sizecolor",children:[v.exports.jsxDEV(Le,{value:t,onChange:c},void 0,!1,{fileName:we,lineNumber:21,columnNumber:7},this),v.exports.jsxDEV(Ct,{value:n,onChange:s},void 0,!1,{fileName:we,lineNumber:22,columnNumber:7},this)]},void 0,!0,{fileName:we,lineNumber:20,columnNumber:5},this)});const Rt=`
min-width: 0 !important;
width: 0 !important;
min-height: 0 !important;
height:0 !important;
visibility: hidden !important;
overflow: hidden !important;
position: absolute !important;
z-index: -1000 !important;
top:0 !important;
right:0 !important;
`,St=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","text-indent","padding-left","padding-right","border-width","box-sizing","white-space","word-break"];let U;function wt(e){const t=window.getComputedStyle(e),n=t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),c=parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),s=parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width"));return{sizingStyle:St.map(o=>`${o}:${t.getPropertyValue(o)}`).join(";"),paddingSize:c,borderSize:s,boxSizing:n}}function Dt(e,t,n,c){U||(U=document.createElement("textarea"),U.setAttribute("tab-index","-1"),document.body.appendChild(U));const{paddingSize:s,borderSize:r,boxSizing:o,sizingStyle:a}=wt(e);U.setAttribute("style",`${a};${Rt};max-width:${n}px;max-height:${c}px`),U.value=t||" ";let m=U.scrollWidth,p=U.scrollHeight;return o==="border-box"?(m+=r,p+=r):o==="content-box"&&(m-=s,p-=s),{width:Math.min(m,n),height:Math.min(p,c)}}var zt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsTextarea/index.tsx",Et=i.exports.memo(function({x:t,y:n,maxWidth:c,maxHeight:s,size:r,color:o,value:a,onChange:m,onBlur:p}){const l=i.exports.useRef(null),u=i.exports.useRef(null),[h,f]=i.exports.useState(0),[d,N]=i.exports.useState(0),C=()=>(l.current||(l.current=document.createElement("div")),l.current);return i.exports.useLayoutEffect(()=>(l.current&&(document.body.appendChild(l.current),requestAnimationFrame(()=>{var y;(y=u.current)==null||y.focus()})),()=>{var y;(y=l.current)==null||y.remove()}),[]),i.exports.useLayoutEffect(()=>{if(!u.current)return;const{width:y,height:S}=Dt(u.current,a,c,s);f(y),N(S)},[a,c,s]),Ve.exports.createPortal(v.exports.jsxDEV("textarea",{ref:u,className:"screenshots-textarea",style:{color:o,width:h,height:d,maxWidth:c,maxHeight:s,fontSize:r,lineHeight:`${r}px`,transform:`translate(${t}px, ${n}px)`},value:a,onChange:y=>m&&m(y.target.value),onBlur:y=>p&&p(y)},void 0,!1,{fileName:zt,lineNumber:65,columnNumber:5},this),C())});function ae(e){const t=ee();i.exports.useEffect(()=>(t.on("drawselect",e),()=>{t.off("drawselect",e)}),[e,t])}var De="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Text/index.tsx";const ze={3:18,6:32,9:46};function jt(e,t){const{size:n,color:c,fontFamily:s,x:r,y:o,text:a}=t.data;e.fillStyle=c,e.textAlign="left",e.textBaseline="top",e.font=`${n}px ${s}`;const m=t.editHistory.reduce((p,{data:l})=>({x:p.x+l.x2-l.x1,y:p.y+l.y2-l.y1}),{x:0,y:0});a.split(`
`).forEach((p,l)=>{e.fillText(p,r+m.x,o+m.y+l*n)})}function Bt(e,t,n){e.textAlign="left",e.textBaseline="top",e.font=`${t.data.size}px ${t.data.fontFamily}`;let c=0,s=0;t.data.text.split(`
`).forEach(u=>{const h=e.measureText(u);c<h.width&&(c=h.width),s+=t.data.size});const{x:r,y:o}=t.editHistory.reduce((u,{data:h})=>({x:u.x+h.x2-h.x1,y:u.y+h.y2-h.y1}),{x:0,y:0}),a=t.data.x+r,m=t.data.y+o,p=a+c,l=m+s;return n.x>=a&&n.x<=p&&n.y>=m&&n.y<=l}function Mt(){const e=Y(),[t,n]=L(),[c]=G(),[s,r]=I(),[,o]=O(),a=W(),[m,p]=i.exports.useState(3),[l,u]=i.exports.useState("#ee5126"),h=i.exports.useRef(null),f=i.exports.useRef(null),[d,N]=i.exports.useState(null),[C,y]=i.exports.useState(""),S=s==="Text",D=i.exports.useCallback(()=>{r.set("Text"),o.set("default")},[r,o]),g=i.exports.useCallback(()=>{S||(D(),n.clearSelect())},[S,D,n]),x=i.exports.useCallback(B=>{h.current&&(h.current.data.size=ze[B]),p(B)},[]),b=i.exports.useCallback(B=>{h.current&&(h.current.data.color=B),u(B)},[]),k=i.exports.useCallback(B=>{y(B),S&&h.current&&(h.current.data.text=B)},[S]),w=i.exports.useCallback(()=>{h.current&&h.current.data.text&&n.push(h.current),h.current=null,y(""),N(null)},[n]),E=i.exports.useCallback((B,_)=>{B.name==="Text"&&(D(),f.current={type:j.Edit,data:{x1:_.clientX,y1:_.clientY,x2:_.clientX,y2:_.clientY},source:B},n.select(B))},[D,n]),z=i.exports.useCallback(B=>{if(!S||!a.current||h.current||!c)return;const{left:_,top:ve}=a.current.canvas.getBoundingClientRect(),be=window.getComputedStyle(a.current.canvas).fontFamily,ne=B.clientX-_,oe=B.clientY-ve;h.current={name:"Text",type:j.Source,data:{size:ze[m],color:l,fontFamily:be,x:ne,y:oe,text:""},editHistory:[],draw:jt,isHit:Bt},N({x:B.clientX,y:B.clientY,maxWidth:c.width-ne,maxHeight:c.height-oe})},[S,m,l,c,a]),R=i.exports.useCallback(B=>{!S||f.current&&(f.current.data.x2=B.clientX,f.current.data.y2=B.clientY,t.top!==f.current?(f.current.source.editHistory.push(f.current),n.push(f.current)):n.set(t))},[S,t,n]),A=i.exports.useCallback(()=>{!S||(f.current=null)},[S]);return ae(E),te(z),se(R),re(A),v.exports.jsxDEV(v.exports.Fragment,{children:[v.exports.jsxDEV(X,{title:e.operation_text_title,icon:"icon-text",checked:S,onClick:g,option:v.exports.jsxDEV(ie,{size:m,color:l,onSizeChange:x,onColorChange:b},void 0,!1,{fileName:De,lineNumber:261,columnNumber:11},this)},void 0,!1,{fileName:De,lineNumber:255,columnNumber:7},this),S&&d&&v.exports.jsxDEV(Et,{x:d.x,y:d.y,maxWidth:d.maxWidth,maxHeight:d.maxHeight,size:ze[m],color:l,value:C,onChange:k,onBlur:w},void 0,!1,{fileName:De,lineNumber:265,columnNumber:9},this)]},void 0,!0)}const Fe=4;function M(e,t,n){e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",e.beginPath(),e.arc(t,n,Fe,0,2*Math.PI),e.fill(),e.stroke()}function ge(e,t,n){t.draw(e,t);const{data:c}=e.getImageData(n.x,n.y,1,1);return c.some(s=>s!==0)}function $(e,t,n){if(!e)return!1;const{left:c,top:s}=e.getBoundingClientRect(),r=t.clientX-c,o=t.clientY-s;return(n.x-r)**2+(n.y-o)**2<Fe**2}function $t(e,t){const{size:n,color:c,points:s}=t.data;e.lineCap="round",e.lineJoin="round",e.lineWidth=n,e.strokeStyle=c;const r=t.editHistory.reduce((o,{data:a})=>({x:o.x+a.x2-a.x1,y:o.y+a.y2-a.y1}),{x:0,y:0});e.beginPath(),s.forEach((o,a)=>{a===0?e.moveTo(o.x+r.x,o.y+r.y):e.lineTo(o.x+r.x,o.y+r.y)}),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.beginPath(),s.forEach((o,a)=>{a===0?e.moveTo(o.x+r.x,o.y+r.y):e.lineTo(o.x+r.x,o.y+r.y)}),e.stroke())}var Ye="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Brush/index.tsx";function Vt(){const e=Y(),[,t]=O(),[n,c]=I(),s=W(),[r,o]=L(),[a,m]=i.exports.useState(3),[p,l]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),h=i.exports.useRef(null),f=n==="Brush",d=i.exports.useCallback(()=>{c.set("Brush"),t.set("default")},[c,t]),N=i.exports.useCallback(()=>{f||(d(),o.clearSelect())},[f,d,o]),C=i.exports.useCallback((g,x)=>{g.name==="Brush"&&(d(),h.current={type:j.Edit,data:{x1:x.clientX,y1:x.clientY,x2:x.clientX,y2:x.clientY},source:g},o.select(g))},[d,o]),y=i.exports.useCallback(g=>{if(!f||u.current||!s.current)return;const{left:x,top:b}=s.current.canvas.getBoundingClientRect();u.current={name:"Brush",type:j.Source,data:{size:a,color:p,points:[{x:g.clientX-x,y:g.clientY-b}]},editHistory:[],draw:$t,isHit:ge}},[f,s,a,p]),S=i.exports.useCallback(g=>{if(!(!f||!s.current)){if(h.current)h.current.data.x2=g.clientX,h.current.data.y2=g.clientY,r.top!==h.current?(h.current.source.editHistory.push(h.current),o.push(h.current)):o.set(r);else if(u.current){const{left:x,top:b}=s.current.canvas.getBoundingClientRect();u.current.data.points.push({x:g.clientX-x,y:g.clientY-b}),r.top!==u.current?o.push(u.current):o.set(r)}}},[f,r,s,o]),D=i.exports.useCallback(()=>{!f||(u.current&&o.clearSelect(),u.current=null,h.current=null)},[f,o]);return ae(C),te(y),se(S),re(D),v.exports.jsxDEV(X,{title:e.operation_brush_title,icon:"icon-brush",checked:f,onClick:N,option:v.exports.jsxDEV(ie,{size:a,color:p,onSizeChange:m,onColorChange:l},void 0,!1,{fileName:Ye,lineNumber:166,columnNumber:15},this)},void 0,!1,{fileName:Ye,lineNumber:161,columnNumber:5},this)}function Te(e){let{x1:t,y1:n,x2:c,y2:s}=e.data;return e.editHistory.forEach(({data:r})=>{const o=r.x2-r.x1,a=r.y2-r.y1;r.type===le.Move?(t+=o,n+=a,c+=o,s+=a):r.type===le.MoveStart?(t+=o,n+=a):r.type===le.MoveEnd&&(c+=o,s+=a)}),me(H({},e.data),{x1:t,x2:c,y1:n,y2:s})}function _t(e,t){const{size:n,color:c,x1:s,x2:r,y1:o,y2:a}=Te(t);e.lineCap="round",e.lineJoin="bevel",e.lineWidth=n,e.strokeStyle=c;const m=r-s,p=a-o,l=n*3,u=Math.atan2(p,m);e.beginPath(),e.moveTo(s,o),e.lineTo(r,a),e.lineTo(r-l*Math.cos(u-Math.PI/6),a-l*Math.sin(u-Math.PI/6)),e.moveTo(r,a),e.lineTo(r-l*Math.cos(u+Math.PI/6),a-l*Math.sin(u+Math.PI/6)),e.stroke(),t.isSelected&&(M(e,s,o),M(e,r,a))}var Ae="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Arrow/index.tsx",le;(function(e){e[e.Move=0]="Move",e[e.MoveStart=1]="MoveStart",e[e.MoveEnd=2]="MoveEnd"})(le||(le={}));function Lt(){const e=Y(),[,t]=O(),[n,c]=I(),[s,r]=L(),o=W(),[a,m]=i.exports.useState(3),[p,l]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),h=i.exports.useRef(null),f=n==="Arrow",d=i.exports.useCallback(()=>{c.set("Arrow"),t.set("default")},[c,t]),N=i.exports.useCallback(()=>{f||(d(),r.clearSelect())},[f,d,r]),C=i.exports.useCallback((g,x)=>{if(g.name!=="Arrow"||!o.current)return;const b=g;d();const{x1:k,y1:w,x2:E,y2:z}=Te(b);let R=0;$(o.current.canvas,x,{x:k,y:w})?R=1:$(o.current.canvas,x,{x:E,y:z})&&(R=2),h.current={type:j.Edit,data:{type:R,x1:x.clientX,y1:x.clientY,x2:x.clientX,y2:x.clientY},source:b},r.select(g)},[o,d,r]),y=i.exports.useCallback(g=>{if(!f||u.current||!o.current)return;const{left:x,top:b}=o.current.canvas.getBoundingClientRect();u.current={name:"Arrow",type:j.Source,data:{size:a,color:p,x1:g.clientX-x,y1:g.clientY-b,x2:g.clientX-x,y2:g.clientY-b},editHistory:[],draw:_t,isHit:ge}},[f,p,a,o]),S=i.exports.useCallback(g=>{if(!(!f||!o.current)){if(h.current)h.current.data.x2=g.clientX,h.current.data.y2=g.clientY,s.top!==h.current?(h.current.source.editHistory.push(h.current),r.push(h.current)):r.set(s);else if(u.current){const{left:x,top:b}=o.current.canvas.getBoundingClientRect();u.current.data.x2=g.clientX-x,u.current.data.y2=g.clientY-b,s.top!==u.current?r.push(u.current):r.set(s)}}},[f,s,o,r]),D=i.exports.useCallback(()=>{!f||(u.current&&r.clearSelect(),u.current=null,h.current=null)},[f,r]);return ae(C),te(y),se(S),re(D),v.exports.jsxDEV(X,{title:e.operation_arrow_title,icon:"icon-arrow",checked:f,onClick:N,option:v.exports.jsxDEV(ie,{size:a,color:p,onSizeChange:m,onColorChange:l},void 0,!1,{fileName:Ae,lineNumber:190,columnNumber:15},this)},void 0,!1,{fileName:Ae,lineNumber:185,columnNumber:5},this)}function He(e){let{x1:t,y1:n,x2:c,y2:s}=e.data;return e.editHistory.forEach(({data:r})=>{const o=r.x2-r.x1,a=r.y2-r.y1;r.type===P.Move?(t+=o,n+=a,c+=o,s+=a):r.type===P.ResizeTop?n+=a:r.type===P.ResizeRightTop?(c+=o,n+=a):r.type===P.ResizeRight?c+=o:r.type===P.ResizeRightBottom?(c+=o,s+=a):r.type===P.ResizeBottom?s+=a:r.type===P.ResizeLeftBottom?(t+=o,s+=a):r.type===P.ResizeLeft?t+=o:r.type===P.ResizeLeftTop&&(t+=o,n+=a)}),me(H({},e.data),{x1:t,x2:c,y1:n,y2:s})}function Xt(e,t){const{size:n,color:c,x1:s,y1:r,x2:o,y2:a}=He(t);e.lineCap="butt",e.lineJoin="miter",e.lineWidth=n,e.strokeStyle=c;const m=(s+o)/2,p=(r+a)/2,l=Math.abs(o-s)/2,u=Math.abs(a-r)/2,h=.5522848,f=l*h,d=u*h;e.beginPath(),e.moveTo(m-l,p),e.bezierCurveTo(m-l,p-d,m-f,p-u,m,p-u),e.bezierCurveTo(m+f,p-u,m+l,p-d,m+l,p),e.bezierCurveTo(m+l,p+d,m+f,p+u,m,p+u),e.bezierCurveTo(m-f,p+u,m-l,p+d,m-l,p),e.closePath(),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",e.beginPath(),e.moveTo(s,r),e.lineTo(o,r),e.lineTo(o,a),e.lineTo(s,a),e.closePath(),e.stroke(),M(e,(s+o)/2,r),M(e,o,r),M(e,o,(r+a)/2),M(e,o,a),M(e,(s+o)/2,a),M(e,s,a),M(e,s,(r+a)/2),M(e,s,r))}var Oe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Ellipse/index.tsx",P;(function(e){e[e.Move=0]="Move",e[e.ResizeTop=1]="ResizeTop",e[e.ResizeRightTop=2]="ResizeRightTop",e[e.ResizeRight=3]="ResizeRight",e[e.ResizeRightBottom=4]="ResizeRightBottom",e[e.ResizeBottom=5]="ResizeBottom",e[e.ResizeLeftBottom=6]="ResizeLeftBottom",e[e.ResizeLeft=7]="ResizeLeft",e[e.ResizeLeftTop=8]="ResizeLeftTop"})(P||(P={}));function Pt(){const e=Y(),[t,n]=L(),[c,s]=I(),[,r]=O(),o=W(),[a,m]=i.exports.useState(3),[p,l]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),h=i.exports.useRef(null),f=c==="Ellipse",d=i.exports.useCallback(()=>{s.set("Ellipse"),r.set("crosshair")},[s,r]),N=i.exports.useCallback(()=>{f||(d(),n.clearSelect())},[f,d,n]),C=i.exports.useCallback((g,x)=>{if(g.name!=="Ellipse"||!o.current)return;const b=g;d();const{x1:k,y1:w,x2:E,y2:z}=He(b);let R=0;$(o.current.canvas,x,{x:(k+E)/2,y:w})?R=1:$(o.current.canvas,x,{x:E,y:w})?R=2:$(o.current.canvas,x,{x:E,y:(w+z)/2})?R=3:$(o.current.canvas,x,{x:E,y:z})?R=4:$(o.current.canvas,x,{x:(k+E)/2,y:z})?R=5:$(o.current.canvas,x,{x:k,y:z})?R=6:$(o.current.canvas,x,{x:k,y:(w+z)/2})?R=7:$(o.current.canvas,x,{x:k,y:w})&&(R=8),h.current={type:j.Edit,data:{type:R,x1:x.clientX,y1:x.clientY,x2:x.clientX,y2:x.clientY},source:b},n.select(g)},[o,d,n]),y=i.exports.useCallback(g=>{if(!f||!o.current||u.current)return;const{left:x,top:b}=o.current.canvas.getBoundingClientRect(),k=g.clientX-x,w=g.clientY-b;u.current={name:"Ellipse",type:j.Source,data:{size:a,color:p,x1:k,y1:w,x2:k,y2:w},editHistory:[],draw:Xt,isHit:ge}},[f,a,p,o]),S=i.exports.useCallback(g=>{if(!(!f||!o.current)){if(h.current)h.current.data.x2=g.clientX,h.current.data.y2=g.clientY,t.top!==h.current?(h.current.source.editHistory.push(h.current),n.push(h.current)):n.set(t);else if(u.current){const{left:x,top:b}=o.current.canvas.getBoundingClientRect();u.current.data.x2=g.clientX-x,u.current.data.y2=g.clientY-b,t.top!==u.current?n.push(u.current):n.set(t)}}},[f,o,t,n]),D=i.exports.useCallback(()=>{!f||(u.current&&n.clearSelect(),u.current=null,h.current=null)},[f,n]);return ae(C),te(y),se(S),re(D),v.exports.jsxDEV(X,{title:e.operation_ellipse_title,icon:"icon-ellipse",checked:f,onClick:N,option:v.exports.jsxDEV(ie,{size:a,color:p,onSizeChange:m,onColorChange:l},void 0,!1,{fileName:Oe,lineNumber:242,columnNumber:15},this)},void 0,!1,{fileName:Oe,lineNumber:237,columnNumber:5},this)}function Ie(e){let{x1:t,y1:n,x2:c,y2:s}=e.data;return e.editHistory.forEach(({data:r})=>{const o=r.x2-r.x1,a=r.y2-r.y1;r.type===F.Move?(t+=o,n+=a,c+=o,s+=a):r.type===F.ResizeTop?n+=a:r.type===F.ResizeRightTop?(c+=o,n+=a):r.type===F.ResizeRight?c+=o:r.type===F.ResizeRightBottom?(c+=o,s+=a):r.type===F.ResizeBottom?s+=a:r.type===F.ResizeLeftBottom?(t+=o,s+=a):r.type===F.ResizeLeft?t+=o:r.type===F.ResizeLeftTop&&(t+=o,n+=a)}),me(H({},e.data),{x1:t,x2:c,y1:n,y2:s})}function Ft(e,t){const{size:n,color:c,x1:s,y1:r,x2:o,y2:a}=Ie(t);e.lineCap="butt",e.lineJoin="miter",e.lineWidth=n,e.strokeStyle=c,e.beginPath(),e.moveTo(s,r),e.lineTo(o,r),e.lineTo(o,a),e.lineTo(s,a),e.closePath(),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",M(e,(s+o)/2,r),M(e,o,r),M(e,o,(r+a)/2),M(e,o,a),M(e,(s+o)/2,a),M(e,s,a),M(e,s,(r+a)/2),M(e,s,r))}var We="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Rectangle/index.tsx",F;(function(e){e[e.Move=0]="Move",e[e.ResizeTop=1]="ResizeTop",e[e.ResizeRightTop=2]="ResizeRightTop",e[e.ResizeRight=3]="ResizeRight",e[e.ResizeRightBottom=4]="ResizeRightBottom",e[e.ResizeBottom=5]="ResizeBottom",e[e.ResizeLeftBottom=6]="ResizeLeftBottom",e[e.ResizeLeft=7]="ResizeLeft",e[e.ResizeLeftTop=8]="ResizeLeftTop"})(F||(F={}));function Yt(){const e=Y(),[t,n]=L(),[c,s]=I(),[,r]=O(),o=W(),[a,m]=i.exports.useState(3),[p,l]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),h=i.exports.useRef(null),f=c==="Rectangle",d=i.exports.useCallback(()=>{s.set("Rectangle"),r.set("crosshair")},[s,r]),N=i.exports.useCallback(()=>{f||(d(),n.clearSelect())},[f,d,n]),C=i.exports.useCallback((g,x)=>{if(g.name!=="Rectangle"||!o.current)return;const b=g;d();const{x1:k,y1:w,x2:E,y2:z}=Ie(b);let R=0;$(o.current.canvas,x,{x:(k+E)/2,y:w})?R=1:$(o.current.canvas,x,{x:E,y:w})?R=2:$(o.current.canvas,x,{x:E,y:(w+z)/2})?R=3:$(o.current.canvas,x,{x:E,y:z})?R=4:$(o.current.canvas,x,{x:(k+E)/2,y:z})?R=5:$(o.current.canvas,x,{x:k,y:z})?R=6:$(o.current.canvas,x,{x:k,y:(w+z)/2})?R=7:$(o.current.canvas,x,{x:k,y:w})&&(R=8),h.current={type:j.Edit,data:{type:R,x1:x.clientX,y1:x.clientY,x2:x.clientX,y2:x.clientY},source:g},n.select(g)},[o,d,n]),y=i.exports.useCallback(g=>{if(!f||!o.current||u.current)return;const{left:x,top:b}=o.current.canvas.getBoundingClientRect(),k=g.clientX-x,w=g.clientY-b;u.current={name:"Rectangle",type:j.Source,data:{size:a,color:p,x1:k,y1:w,x2:k,y2:w},editHistory:[],draw:Ft,isHit:ge}},[f,a,p,o]),S=i.exports.useCallback(g=>{if(!(!f||!o.current)){if(h.current)h.current.data.x2=g.clientX,h.current.data.y2=g.clientY,t.top!==h.current?(h.current.source.editHistory.push(h.current),n.push(h.current)):n.set(t);else if(u.current){const{left:x,top:b}=o.current.canvas.getBoundingClientRect(),k=u.current.data;k.x2=g.clientX-x,k.y2=g.clientY-b,t.top!==u.current?n.push(u.current):n.set(t)}}},[f,o,t,n]),D=i.exports.useCallback(()=>{!f||(u.current&&n.clearSelect(),u.current=null,h.current=null)},[f,n]);return ae(C),te(y),se(S),re(D),v.exports.jsxDEV(X,{title:e.operation_rectangle_title,icon:"icon-rectangle",checked:f,onClick:N,option:v.exports.jsxDEV(ie,{size:a,color:p,onSizeChange:m,onColorChange:l},void 0,!1,{fileName:We,lineNumber:242,columnNumber:15},this)},void 0,!1,{fileName:We,lineNumber:237,columnNumber:5},this)}var Tt=[Yt,Pt,Lt,Vt,Mt,kt,"|",yt,vt,"|",dt,pt,ht];var ue="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsOperations/index.tsx";const Ue=$e.createContext(null);var At=i.exports.memo(function(){var u,h;const{width:t,height:n}=V(),[c]=G(),[s,r]=i.exports.useState(null),[o,a]=i.exports.useState(null),m=i.exports.useRef(null),p=i.exports.useCallback(f=>{f.stopPropagation()},[]),l=i.exports.useCallback(f=>{f.preventDefault(),f.stopPropagation()},[]);return i.exports.useEffect(()=>{if(!c||!m.current)return;const f=m.current.getBoundingClientRect();let d=c.x+c.width-f.width,N=c.y+c.height+10;d<0&&(d=0),d>t-f.width&&(d=t-f.width),N>n-f.height&&(N=n-f.height-10),(!o||Math.abs(o.x-d)>1||Math.abs(o.y-N)>1)&&a({x:d,y:N}),(!s||Math.abs(s.x-f.x)>1||Math.abs(s.y-f.y)>1||Math.abs(s.width-f.width)>1||Math.abs(s.height-f.height)>1)&&r({x:f.x,y:f.y,width:f.width,height:f.height})}),c?v.exports.jsxDEV(Ue.Provider,{value:s,children:v.exports.jsxDEV("div",{ref:m,className:"screenshots-operations",style:{visibility:o?"visible":"hidden",transform:`translate(${(u=o==null?void 0:o.x)!=null?u:0}px, ${(h=o==null?void 0:o.y)!=null?h:0}px)`},onDoubleClick:p,onContextMenu:l,children:v.exports.jsxDEV("div",{className:"screenshots-operations-buttons",children:Tt.map((f,d)=>f==="|"?v.exports.jsxDEV("div",{className:"screenshots-operations-divider"},d,!1,{fileName:ue,lineNumber:93,columnNumber:22},this):v.exports.jsxDEV(f,{},d,!1,{fileName:ue,lineNumber:95,columnNumber:22},this))},void 0,!1,{fileName:ue,lineNumber:90,columnNumber:9},this)},void 0,!1,{fileName:ue,lineNumber:80,columnNumber:7},this)},void 0,!1,{fileName:ue,lineNumber:79,columnNumber:5},this):null});function Ht(e){const[t,n]=i.exports.useState(null);return i.exports.useEffect(()=>{if(n(null),e==null)return;const c=document.createElement("img"),s=()=>n(c),r=()=>n(null);return c.addEventListener("load",s),c.addEventListener("error",r),c.src=e,()=>{c.removeEventListener("load",s),c.removeEventListener("error",r)}},[e]),t}var fe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/index.tsx";function Ot(o){var a=o,{url:e,width:t,height:n,lang:c,className:s}=a,r=Me(a,["url","width","height","lang","className"]);const m=Ht(e),p=i.exports.useRef(null),l=i.exports.useRef({}),[u,h]=i.exports.useState({index:-1,stack:[]}),[f,d]=i.exports.useState(null),[N,C]=i.exports.useState("move"),[y,S]=i.exports.useState(void 0),D={url:e,width:t,height:n,image:m,lang:H(H({},_e),c),emiterRef:l,canvasContextRef:p,history:u,bounds:f,cursor:N,operation:y},g=i.exports.useCallback((z,...R)=>{const A=r[z];typeof A=="function"&&A(...R)},[r]),x={call:g,setHistory:h,setBounds:d,setCursor:C,setOperation:S},b=["screenshots"];s&&b.push(s);const k=()=>{l.current={},h({index:-1,stack:[]}),d(null),C("move"),S(void 0)},w=i.exports.useCallback(async z=>{if(!(z.button!==0||!m))if(f&&p.current)pe({image:m,width:t,height:n,history:u,bounds:f}).then(R=>{g("onOk",R,f),k()});else{const R={x:0,y:0,width:t,height:n};pe({image:m,width:t,height:n,history:u,bounds:R}).then(A=>{g("onOk",A,R),k()})}},[m,u,f,t,n,g]),E=i.exports.useCallback(z=>{z.button===2&&(z.preventDefault(),g("onCancel"),k())},[g]);return i.exports.useLayoutEffect(()=>{k()},[e]),v.exports.jsxDEV(ye.Provider,{value:{store:D,dispatcher:x},children:v.exports.jsxDEV("div",{className:b.join(" "),style:{width:t,height:n},onDoubleClick:w,onContextMenu:E,children:[v.exports.jsxDEV(rt,{},void 0,!1,{fileName:fe,lineNumber:149,columnNumber:9},this),v.exports.jsxDEV(lt,{ref:p},void 0,!1,{fileName:fe,lineNumber:150,columnNumber:9},this),v.exports.jsxDEV(At,{},void 0,!1,{fileName:fe,lineNumber:151,columnNumber:9},this)]},void 0,!0,{fileName:fe,lineNumber:143,columnNumber:7},this)},void 0,!1,{fileName:fe,lineNumber:142,columnNumber:5},this)}var It="./assets/image.5cf1218d.jpg",Je="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/web/app.tsx";function Wt(){const e=i.exports.useCallback((c,s)=>{if(console.log("save",c,s),c){const r=URL.createObjectURL(c);console.log(r),window.open(r)}},[]),t=i.exports.useCallback(()=>{console.log("cancel")},[]),n=i.exports.useCallback((c,s)=>{if(console.log("ok",c,s),c){const r=URL.createObjectURL(c);console.log(r),window.open(r)}},[]);return v.exports.jsxDEV("div",{className:"body",children:v.exports.jsxDEV(Ot,{url:It,width:window.innerWidth,height:window.innerHeight,lang:{operation_rectangle_title:"Rectangle"},onSave:e,onCancel:t,onOk:n},void 0,!1,{fileName:Je,lineNumber:30,columnNumber:7},this)},void 0,!1,{fileName:Je,lineNumber:29,columnNumber:5},this)}var qe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/web/index.tsx";Ze.render(v.exports.jsxDEV(i.exports.StrictMode,{children:v.exports.jsxDEV(Wt,{},void 0,!1,{fileName:qe,lineNumber:7,columnNumber:5},globalThis)},void 0,!1,{fileName:qe,lineNumber:6,columnNumber:3},globalThis),document.getElementById("app"));
