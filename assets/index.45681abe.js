var Qe=Object.defineProperty,Ze=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var Be=(e,t,n)=>t in e?Qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,A=(e,t)=>{for(var n in t||(t={}))Ee.call(t,n)&&Be(e,n,t[n]);if(he)for(var n of he(t))je.call(t,n)&&Be(e,n,t[n]);return e},pe=(e,t)=>Ze(e,et(t));var Me=(e,t)=>{var n={};for(var o in e)Ee.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&he)for(var o of he(e))t.indexOf(o)<0&&je.call(e,o)&&(n[o]=e[o]);return n};import{R as _e,r as i,j as v,a as Ve,b as tt}from"./vendor.44b7eecb.js";const st=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const r of c)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(c){const r={};return c.integrity&&(r.integrity=c.integrity),c.referrerpolicy&&(r.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?r.credentials="include":c.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(c){if(c.ep)return;c.ep=!0;const r=n(c);fetch(c.href,r)}};st();const $e={magnifier_position_label:"\u5750\u6807",operation_ok_title:"\u786E\u5B9A",operation_cancel_title:"\u53D6\u6D88",operation_save_title:"\u4FDD\u5B58",operation_redo_title:"\u91CD\u505A",operation_undo_title:"\u64A4\u9500",operation_mosaic_title:"\u9A6C\u8D5B\u514B",operation_text_title:"\u6587\u672C",operation_brush_title:"\u753B\u7B14",operation_arrow_title:"\u7BAD\u5934",operation_ellipse_title:"\u692D\u5706",operation_rectangle_title:"\u77E9\u5F62"};var ye=_e.createContext({store:{url:void 0,image:null,width:0,height:0,lang:$e,emiterRef:{current:{}},canvasContextRef:{current:null},history:{index:-1,stack:[]},bounds:null,cursor:"move",operation:void 0},dispatcher:{call:void 0,setHistory:void 0,setBounds:void 0,setCursor:void 0,setOperation:void 0}});function oe(){const{dispatcher:e}=i.exports.useContext(ye);return e}function $(){const{store:e}=i.exports.useContext(ye);return e}function H(){const{bounds:e}=$(),{setBounds:t}=oe(),n=i.exports.useCallback(c=>{t==null||t(c)},[t]),o=i.exports.useCallback(()=>{t==null||t(null)},[t]);return[e,{set:n,reset:o}]}function L(){const{lang:e}=$();return e}var G="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsMagnifier/index.tsx";const K=100,Q=80;function rt({x:e,y:t}){const{width:n,height:o,image:c}=$(),r=L(),[s,l]=i.exports.useState(null),x=i.exports.useRef(null),a=i.exports.useRef(null),h=i.exports.useRef(null),[f,u]=i.exports.useState("000000");return i.exports.useLayoutEffect(()=>{if(!x.current)return;const p=x.current.getBoundingClientRect();let d=e+20,b=t+20;d+p.width>n&&(d=e-p.width-20),b+p.height>o&&(b=t-p.height-20),d<0&&(d=0),b<0&&(b=0),l({x:d,y:b})},[n,o,e,t]),i.exports.useEffect(()=>{if(!c||!a.current){h.current=null;return}if(h.current||(h.current=a.current.getContext("2d")),!h.current)return;const p=h.current;p.clearRect(0,0,K,Q);const d=c.naturalWidth/n,b=c.naturalHeight/o;p.drawImage(c,e*d-K/2,t*b-Q/2,K,Q,0,0,K,Q);const{data:N}=p.getImageData(Math.floor(K/2),Math.floor(Q/2),1,1),w=Array.from(N.slice(0,3)).map(C=>C>=16?C.toString(16):`0${C.toString(16)}`).join("").toUpperCase();u(w)},[n,o,c,e,t]),v.exports.jsxDEV("div",{ref:x,className:"screenshots-magnifier",style:{transform:`translate(${s==null?void 0:s.x}px, ${s==null?void 0:s.y}px)`},children:[v.exports.jsxDEV("div",{className:"screenshots-magnifier-body",children:v.exports.jsxDEV("canvas",{ref:a,className:"screenshots-magnifier-body-canvas",width:K,height:Q},void 0,!1,{fileName:G,lineNumber:97,columnNumber:9},this)},void 0,!1,{fileName:G,lineNumber:96,columnNumber:7},this),v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer",children:[v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer-item",children:[r.magnifier_position_label,": (",e,",",t,")"]},void 0,!0,{fileName:G,lineNumber:105,columnNumber:9},this),v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer-item",children:["RGB: #",f]},void 0,!0,{fileName:G,lineNumber:108,columnNumber:9},this)]},void 0,!0,{fileName:G,lineNumber:104,columnNumber:7},this)]},void 0,!0,{fileName:G,lineNumber:89,columnNumber:5},this)}function nt({x:e,y:t},{x:n,y:o},c,r){return e>n&&([e,n]=[n,e]),t>o&&([t,o]=[o,t]),e<0&&(e=0),n>c&&(n=c),t<0&&(t=0),o>r&&(o=r),{x:e,y:t,width:n-e,height:o-t}}var me="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsBackground/index.tsx";function ot(){const{url:e,image:t,width:n,height:o}=$(),[c,r]=H(),s=i.exports.useRef(null),l=i.exports.useRef(null),[x,a]=i.exports.useState(null),h=i.exports.useCallback((u,p)=>{if(!s.current)return;const{x:d,y:b}=s.current.getBoundingClientRect();r.set(nt({x:u.x-d,y:u.y-b},{x:p.x-d,y:p.y-b},n,o))},[n,o,r]),f=i.exports.useCallback(u=>{l.current||c||u.button!==0||(l.current={x:u.clientX,y:u.clientY})},[c]);return i.exports.useEffect(()=>{const u=d=>{if(s.current){const b=s.current.getBoundingClientRect();d.clientX<b.left||d.clientY<b.top||d.clientX>b.right||d.clientY>b.bottom?a(null):a({x:d.clientX-b.x,y:d.clientY-b.y})}!l.current||h(l.current,{x:d.clientX,y:d.clientY})},p=d=>{!l.current||(h(l.current,{x:d.clientX,y:d.clientY}),l.current=null)};return window.addEventListener("mousemove",u),window.addEventListener("mouseup",p),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",p)}},[h]),!e||!t?null:v.exports.jsxDEV("div",{ref:s,className:"screenshots-background",onMouseDown:f,children:[v.exports.jsxDEV("img",{className:"screenshots-background-image",src:e},void 0,!1,{fileName:me,lineNumber:110,columnNumber:7},this),v.exports.jsxDEV("div",{className:"screenshots-background-mask"},void 0,!1,{fileName:me,lineNumber:111,columnNumber:7},this),x&&!c&&v.exports.jsxDEV(rt,{x:x==null?void 0:x.x,y:x==null?void 0:x.y},void 0,!1,{fileName:me,lineNumber:112,columnNumber:31},this)]},void 0,!0,{fileName:me,lineNumber:105,columnNumber:5},this)}var Ke;const Le=(Ke=window.devicePixelRatio)!=null?Ke:2;var xe=Le<2?2:Le;function ct(e,t,n,o){const c=e.clientX-n.x,r=e.clientY-n.y;let s=o.x,l=o.y,x=o.x+o.width,a=o.y+o.height;switch(t){case"top":l+=r;break;case"top-right":x+=c,l+=r;break;case"right":x+=c;break;case"right-bottom":x+=c,a+=r;break;case"bottom":a+=r;break;case"bottom-left":s+=c,a+=r;break;case"left":s+=c;break;case"left-top":s+=c,l+=r;break;case"move":s+=c,l+=r,x+=c,a+=r;break}return[{x:s,y:l},{x,y:a}]}function it({x:e,y:t},{x:n,y:o},c,r,s,l){return e>n&&([e,n]=[n,e]),t>o&&([t,o]=[o,t]),e<0&&(e=0,l==="move"&&(n=c.width)),n>r&&(n=r,l==="move"&&(e=n-c.width)),t<0&&(t=0,l==="move"&&(o=c.height)),o>s&&(o=s,l==="move"&&(t=o-c.height)),{x:e,y:t,width:Math.max(n-e,1),height:Math.max(o-t,1)}}var j;(function(e){e[e.Edit=0]="Edit",e[e.Source=1]="Source"})(j||(j={}));function Z(){const{emiterRef:e}=$(),t=i.exports.useCallback((r,s)=>{const l=e.current;Array.isArray(l[r])?l[r].push(s):l[r]=[s]},[e]),n=i.exports.useCallback((r,s)=>{const l=e.current;if(Array.isArray(l[r])){const x=l[r].findIndex(a=>a===s);x!==-1&&l[r].splice(x,1)}},[e]),o=i.exports.useCallback((r,...s)=>{const l=e.current;Array.isArray(l[r])&&l[r].forEach(x=>x(...s))},[e]),c=i.exports.useCallback(()=>{e.current={}},[e]);return{on:t,off:n,emit:o,reset:c}}function X(){const{history:e}=$(),{setHistory:t}=oe(),n=i.exports.useCallback(h=>{const{index:f,stack:u}=e;u.forEach(p=>{p.type===j.Source&&(p.isSelected=!1)}),h.type===j.Source?h.isSelected=!0:h.type===j.Edit&&(h.source.isSelected=!0),u.splice(f+1),u.push(h),t==null||t({index:u.length-1,stack:u})},[e,t]),o=i.exports.useCallback(()=>{const{stack:h}=e;h.pop(),t==null||t({index:h.length-1,stack:h})},[e,t]),c=i.exports.useCallback(()=>{const{index:h,stack:f}=e,u=f[h];u&&(u.type===j.Source?u.isSelected=!1:u.type===j.Edit&&u.source.editHistory.pop()),t==null||t({index:h<=0?-1:h-1,stack:f})},[e,t]),r=i.exports.useCallback(()=>{const{index:h,stack:f}=e,u=f[h+1];u&&(u.type===j.Source?u.isSelected=!1:u.type===j.Edit&&u.source.editHistory.push(u)),t==null||t({index:h>=f.length-1?f.length-1:h+1,stack:f})},[e,t]),s=i.exports.useCallback(h=>{t==null||t(A({},h))},[t]),l=i.exports.useCallback(h=>{e.stack.forEach(f=>{f.type===j.Source&&(f===h?f.isSelected=!0:f.isSelected=!1)}),t==null||t(A({},e))},[e,t]),x=i.exports.useCallback(()=>{e.stack.forEach(h=>{h.type===j.Source&&(h.isSelected=!1)}),t==null||t(A({},e))},[e,t]),a=i.exports.useCallback(()=>{t==null||t({index:-1,stack:[]})},[t]);return[{index:e.index,stack:e.stack,top:e.stack.slice(e.index,e.index+1)[0]},{push:n,pop:o,undo:c,redo:r,set:s,select:l,clearSelect:x,reset:a}]}function O(){const{cursor:e}=$(),{setCursor:t}=oe(),n=i.exports.useCallback(c=>{t==null||t(c)},[t]),o=i.exports.useCallback(()=>{t==null||t("move")},[t]);return[e,{set:n,reset:o}]}function I(){const{operation:e}=$(),{setOperation:t}=oe(),n=i.exports.useCallback(c=>{t==null||t(c)},[t]),o=i.exports.useCallback(()=>{t==null||t(void 0)},[t]);return[e,{set:n,reset:o}]}function lt(e,t,n,o){if(!t)return!1;const c=document.createElement("canvas");c.width=e.width,c.height=e.height;const r=c.getContext("2d");if(!r)return!1;const{left:s,top:l}=t.getBoundingClientRect(),x=o.clientX-s,a=o.clientY-l;return[...n.stack.slice(0,n.index+1)].reverse().find(f=>{var u;return f.type!==j.Source?!1:(r.clearRect(0,0,e.width,e.height),(u=f.isHit)==null?void 0:u.call(f,r,f,{x,y:a}))})}var ce="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsCanvas/index.tsx";const at=["top","right","bottom","left"];var T;(function(e){e.ResizeTop="top",e.ResizetopRight="top-right",e.ResizeRight="right",e.ResizeRightBottom="right-bottom",e.ResizeBottom="bottom",e.ResizeBottomLeft="bottom-left",e.ResizeLeft="left",e.ResizeLeftTop="left-top",e.Move="move"})(T||(T={}));const ut=[T.ResizeTop,T.ResizetopRight,T.ResizeRight,T.ResizeRightBottom,T.ResizeBottom,T.ResizeBottomLeft,T.ResizeLeft,T.ResizeLeftTop];var ft=i.exports.forwardRef(function(t,n){const{image:o,width:c,height:r}=$(),s=Z(),[l]=X(),[x]=O(),[a,h]=H(),[f]=I(),u=i.exports.useRef(),p=i.exports.useRef(null),d=i.exports.useRef(null),b=i.exports.useRef(null),N=i.exports.useRef(null),w=i.exports.useCallback(()=>{if(!o||!a||!N.current)return;const m=o.naturalWidth/c,g=o.naturalHeight/r,y=N.current;y.imageSmoothingEnabled=!0,y.imageSmoothingQuality="low",y.setTransform(xe,0,0,xe,0,0),y.clearRect(0,0,a.width,a.height),y.drawImage(o,a.x*m,a.y*g,a.width*m,a.height*g,0,0,a.width,a.height),l.stack.slice(0,l.index+1).forEach(k=>{k.type===j.Source&&k.draw(y,k)})},[o,c,r,a,N,l]),C=i.exports.useCallback((m,g)=>{if(!(m.button!==0||!a))if(!f)u.current=g,p.current={x:m.clientX,y:m.clientY},d.current={x:a.x,y:a.y,width:a.width,height:a.height};else{const y=lt(a,b.current,l,m.nativeEvent);y?s.emit("drawselect",y,m.nativeEvent):s.emit("mousedown",m.nativeEvent)}},[a,f,s,l]),z=i.exports.useCallback(m=>{if(!u.current||!p.current||!d.current||!a)return;const g=ct(m,u.current,p.current,d.current);h.set(it(g[0],g[1],a,c,r,u.current))},[c,r,a,h]);return i.exports.useLayoutEffect(()=>{if(!o||!a||!b.current){N.current=null;return}N.current||(N.current=b.current.getContext("2d")),w()},[o,a,w]),i.exports.useEffect(()=>{const m=y=>{if(f)s.emit("mousemove",y);else{if(!u.current||!p.current||!d.current)return;z(y)}},g=y=>{if(f)s.emit("mouseup",y);else{if(!u.current||!p.current||!d.current)return;z(y),u.current=void 0,p.current=null,d.current=null}};return window.addEventListener("mousemove",m),window.addEventListener("mouseup",g),()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",g)}},[z,f,s]),i.exports.useImperativeHandle(n,()=>N.current),a?v.exports.jsxDEV("div",{className:"screenshots-canvas",style:{left:a.x,top:a.y,width:a.width,height:a.height},children:[v.exports.jsxDEV("canvas",{ref:b,width:a.width*xe,height:a.height*xe,style:{width:a.width,height:a.height}},void 0,!1,{fileName:ce,lineNumber:200,columnNumber:7},this),v.exports.jsxDEV("div",{className:"screenshots-canvas-body",style:{cursor:x},onMouseDown:m=>C(m,"move")},void 0,!1,{fileName:ce,lineNumber:209,columnNumber:7},this),at.map(m=>v.exports.jsxDEV("div",{className:`screenshots-canvas-border-${m}`},m,!1,{fileName:ce,lineNumber:217,columnNumber:16},this)),ut.map(m=>v.exports.jsxDEV("div",{className:`screenshots-canvas-point-${m}`,onMouseDown:g=>C(g,m)},m,!1,{fileName:ce,lineNumber:221,columnNumber:11},this))]},void 0,!0,{fileName:ce,lineNumber:191,columnNumber:5},this):null});function Ne(){const e=oe();return i.exports.useCallback((n,...o)=>{var c;(c=e.call)==null||c.call(e,n,...o)},[e])}function W(){const{canvasContextRef:e}=$();return e}function ke(){const e=Z(),[,t]=H(),[,n]=O(),[,o]=X(),[,c]=I();return i.exports.useCallback(()=>{e.reset(),o.reset(),t.reset(),n.reset(),c.reset()},[e,o,t,n,c])}var Ce="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsOption/index.tsx",q;(function(e){e.Bottom="bottom",e.Top="top"})(q||(q={}));function ht({open:e,content:t,children:n}){const o=i.exports.useRef(null),c=i.exports.useRef(null),r=i.exports.useRef(null),s=i.exports.useContext(Je),[l,x]=i.exports.useState(q.Bottom),[a,h]=i.exports.useState(null),[f,u]=i.exports.useState(0),p=()=>(c.current||(c.current=document.createElement("div")),c.current);return i.exports.useEffect(()=>{const d=p();return e&&document.body.appendChild(d),()=>{d.remove()}},[e]),i.exports.useEffect(()=>{if(!e||!s||!o.current||!r.current)return;const d=o.current.getBoundingClientRect(),b=r.current.getBoundingClientRect();let N=l,w=d.left+d.width/2,C=d.top+d.height,z=f;if(w+b.width/2>s.x+s.width){const m=w;w=s.x+s.width-b.width/2,z=m-w}if(w<s.x+b.width/2){const m=w;w=s.x+b.width/2,z=m-w}C>window.innerHeight-b.height&&(N===q.Bottom&&(N=q.Top),C=d.top-b.height),C<0&&(N===q.Top&&(N=q.Bottom),C=d.top+d.height),N!==l&&x(N),((a==null?void 0:a.x)!==w||a.y!==C)&&h({x:w,y:C}),z!==f&&u(z)}),v.exports.jsxDEV(v.exports.Fragment,{children:[i.exports.cloneElement(n,{ref:o}),e&&t&&Ve.exports.createPortal(v.exports.jsxDEV("div",{ref:r,className:"screenshots-option",style:{visibility:a?"visible":"hidden",left:a==null?void 0:a.x,top:a==null?void 0:a.y},"data-placement":l,children:[v.exports.jsxDEV("div",{className:"screenshots-option-container",children:t},void 0,!1,{fileName:Ce,lineNumber:121,columnNumber:13},this),v.exports.jsxDEV("div",{className:"screenshots-option-arrow",style:{marginLeft:f}},void 0,!1,{fileName:Ce,lineNumber:122,columnNumber:13},this)]},void 0,!0,{fileName:Ce,lineNumber:111,columnNumber:11},this),p())]},void 0,!0)}var Re="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsButton/index.tsx";function F({title:e,icon:t,checked:n,disabled:o,option:c,onClick:r}){const s=["screenshots-button"],l=i.exports.useCallback(x=>{o||!r||r(x)},[o,r]);return n&&s.push("screenshots-button-checked"),o&&s.push("screenshots-button-disabled"),v.exports.jsxDEV(ht,{open:n,content:c,children:v.exports.jsxDEV("div",{className:s.join(" "),title:e,onClick:l,children:v.exports.jsxDEV("span",{className:t},void 0,!1,{fileName:Re,lineNumber:44,columnNumber:9},this)},void 0,!1,{fileName:Re,lineNumber:43,columnNumber:7},this)},void 0,!1,{fileName:Re,lineNumber:42,columnNumber:5},this)}var pt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Ok/index.tsx";function mt(){const e=L(),t=W(),[,n]=X(),o=Ne(),[c]=H(),r=ke(),s=i.exports.useCallback(()=>{n.clearSelect(),setTimeout(()=>{!t.current||t.current.canvas.toBlob(l=>{o("onOk",l,c),r()},"image/png")})},[t,n,o,c,r]);return v.exports.jsxDEV(F,{title:e.operation_ok_title,icon:"icon-ok",onClick:s},void 0,!1,{fileName:pt,lineNumber:31,columnNumber:10},this)}var xt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Cancel/index.tsx";function dt(){const e=Ne(),t=ke(),n=L(),o=i.exports.useCallback(()=>{e("onCancel"),t()},[e,t]);return v.exports.jsxDEV(F,{title:n.operation_cancel_title,icon:"icon-cancel",onClick:o},void 0,!1,{fileName:xt,lineNumber:17,columnNumber:10},this)}var gt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Save/index.tsx";function vt(){const e=L(),t=W(),[,n]=X(),[o]=H(),c=Ne(),r=ke(),s=i.exports.useCallback(()=>{n.clearSelect(),setTimeout(()=>{!t.current||t.current.canvas.toBlob(l=>{c("onSave",l,o),r()},"image/png")})},[t,n,o,c,r]);return v.exports.jsxDEV(F,{title:e.operation_save_title,icon:"icon-save",onClick:s},void 0,!1,{fileName:gt,lineNumber:31,columnNumber:10},this)}var bt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Redo/index.tsx";function yt(){const e=L(),[t,n]=X(),o=i.exports.useCallback(()=>{n.redo()},[n]);return v.exports.jsxDEV(F,{title:e.operation_redo_title,icon:"icon-redo",disabled:!t.stack.length||t.stack.length-1===t.index,onClick:o},void 0,!1,{fileName:bt,lineNumber:15,columnNumber:5},this)}var Nt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Undo/index.tsx";function kt(){const e=L(),[t,n]=X(),o=i.exports.useCallback(()=>{n.undo()},[n]);return v.exports.jsxDEV(F,{title:e.operation_undo_title,icon:"icon-undo",disabled:t.index===-1,onClick:o},void 0,!1,{fileName:Nt,lineNumber:15,columnNumber:5},this)}var Se="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsSize/index.tsx";function Xe({value:e,onChange:t}){const n=[3,6,9];return v.exports.jsxDEV("div",{className:"screenshots-size",children:n.map(o=>{const c=["screenshots-size-item"];return o===e&&c.push("screenshots-size-active"),v.exports.jsxDEV("div",{className:c.join(" "),onClick:()=>t&&t(o),children:v.exports.jsxDEV("div",{className:"screenshots-size-pointer",style:{width:o*1.8,height:o*1.8}},void 0,!1,{fileName:Se,lineNumber:22,columnNumber:13},this)},o,!1,{fileName:Se,lineNumber:21,columnNumber:11},this)})},void 0,!1,{fileName:Se,lineNumber:12,columnNumber:5},this)}function ee(e){const t=Z();i.exports.useEffect(()=>(t.on("mousedown",e),()=>{t.off("mousedown",e)}),[e,t])}function te(e){const t=Z();i.exports.useEffect(()=>(t.on("mousemove",e),()=>{t.off("mousemove",e)}),[e,t])}function se(e){const t=Z();i.exports.useEffect(()=>(t.on("mouseup",e),()=>{t.off("mouseup",e)}),[e,t])}var Fe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Mosaic/index.tsx";function de(e,t,n){if(!n)return[0,0,0,0];const{data:o,width:c}=n,r=t*c*4+e*4;return Array.from(o.slice(r,r+4))}function Ct(e,t){const{tiles:n,size:o}=t.data;n.forEach(c=>{const r=Math.round(c.color[0]),s=Math.round(c.color[1]),l=Math.round(c.color[2]),x=c.color[3]/255;e.fillStyle=`rgba(${r}, ${s}, ${l}, ${x})`,e.fillRect(c.x-o/2,c.y-o/2,o,o)})}function Rt(){const e=L(),{image:t,width:n,height:o}=$(),[c,r]=I(),s=W(),[l,x]=X(),[a]=H(),[,h]=O(),[f,u]=i.exports.useState(3),p=i.exports.useRef(null),d=i.exports.useRef(null),b=c==="Mosaic",N=i.exports.useCallback(()=>{r.set("Mosaic"),h.set("crosshair")},[r,h]),w=i.exports.useCallback(()=>{b||(N(),x.clearSelect())},[b,N,x]),C=i.exports.useCallback(g=>{if(!b||d.current||!p.current||!s.current)return;const y=s.current.canvas.getBoundingClientRect(),k=g.clientX-y.x,S=g.clientY-y.y,E=f*2;d.current={name:"Mosaic",type:j.Source,data:{size:E,tiles:[{x:k,y:S,color:de(k,S,p.current)}]},editHistory:[],draw:Ct}},[b,f,s]),z=i.exports.useCallback(g=>{if(!b||!d.current||!s.current||!p.current)return;const y=s.current.canvas.getBoundingClientRect(),k=g.clientX-y.x,S=g.clientY-y.y,E=d.current.data.size,D=d.current.data.tiles;let R=D[D.length-1];if(!R)D.push({x:k,y:S,color:de(k,S,p.current)});else{const J=R.x-k,B=R.y-S;let V=Math.sqrt(J**2+B**2);const ve=-B/V,be=-J/V;for(;V>E;){const re=Math.floor(R.x+E*be),ne=Math.floor(R.y+E*ve);R={x:re,y:ne,color:de(re,ne,p.current)},D.push(R),V-=E}V>E/2&&D.push({x:k,y:S,color:de(k,S,p.current)})}l.top!==d.current?x.push(d.current):x.set(l)},[b,s,l,x]),m=i.exports.useCallback(()=>{!b||(d.current=null)},[b]);return ee(C),te(z),se(m),i.exports.useEffect(()=>{if(!a||!t||!b)return;const g=document.createElement("canvas"),y=g.getContext("2d");if(!y)return;g.width=a.width,g.height=a.height;const k=t.naturalWidth/n,S=t.naturalHeight/o;y.drawImage(t,a.x*k,a.y*S,a.width*k,a.height*S,0,0,a.width,a.height),p.current=y.getImageData(0,0,a.width,a.height)},[n,o,a,t,b]),v.exports.jsxDEV(F,{title:e.operation_mosaic_title,icon:"icon-mosaic",checked:b,onClick:w,option:v.exports.jsxDEV(Xe,{value:f,onChange:u},void 0,!1,{fileName:Fe,lineNumber:220,columnNumber:15},this)},void 0,!1,{fileName:Fe,lineNumber:215,columnNumber:5},this)}var Ye="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsColor/index.tsx";function St({value:e,onChange:t}){const n=["#ee5126","#fceb4d","#90e746","#51c0fa","#7a7a7a","#ffffff"];return v.exports.jsxDEV("div",{className:"screenshots-color",children:n.map(o=>{const c=["screenshots-color-item"];return o===e&&c.push("screenshots-color-active"),v.exports.jsxDEV("div",{className:c.join(" "),style:{backgroundColor:o},onClick:()=>t&&t(o)},o,!1,{fileName:Ye,lineNumber:19,columnNumber:11},this)})},void 0,!1,{fileName:Ye,lineNumber:12,columnNumber:5},this)}var we="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsSizeColor/index.tsx";function ie({size:e,color:t,onSizeChange:n,onColorChange:o}){return v.exports.jsxDEV("div",{className:"screenshots-sizecolor",children:[v.exports.jsxDEV(Xe,{value:e,onChange:n},void 0,!1,{fileName:we,lineNumber:16,columnNumber:7},this),v.exports.jsxDEV(St,{value:t,onChange:o},void 0,!1,{fileName:we,lineNumber:17,columnNumber:7},this)]},void 0,!0,{fileName:we,lineNumber:15,columnNumber:5},this)}const wt=`
min-width: 0 !important;
width: 0 !important;
min-height: 0 !important;
height:0 !important;
visibility: hidden !important;
overflow: hidden !important;
position: absolute !important;
z-index: -1000 !important;
top:0 !important;
right:0 !important;
`,Dt=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","text-indent","padding-left","padding-right","border-width","box-sizing","white-space","word-break"];let U;function zt(e){const t=window.getComputedStyle(e),n=t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),o=parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),c=parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width"));return{sizingStyle:Dt.map(s=>`${s}:${t.getPropertyValue(s)}`).join(";"),paddingSize:o,borderSize:c,boxSizing:n}}function Et(e,t,n,o){U||(U=document.createElement("textarea"),U.setAttribute("tab-index","-1"),document.body.appendChild(U));const{paddingSize:c,borderSize:r,boxSizing:s,sizingStyle:l}=zt(e);U.setAttribute("style",`${l};${wt};max-width:${n}px;max-height:${o}px`),U.value=t||" ";let x=U.scrollWidth,a=U.scrollHeight;return s==="border-box"?(x+=r,a+=r):s==="content-box"&&(x-=c,a-=c),{width:Math.min(x,n),height:Math.min(a,o)}}var jt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsTextarea/index.tsx";function Bt({x:e,y:t,maxWidth:n,maxHeight:o,size:c,color:r,value:s,onChange:l,onBlur:x}){const a=i.exports.useRef(null),h=i.exports.useRef(null),[f,u]=i.exports.useState(0),[p,d]=i.exports.useState(0),b=()=>(a.current||(a.current=document.createElement("div")),a.current);return i.exports.useLayoutEffect(()=>(a.current&&(document.body.appendChild(a.current),requestAnimationFrame(()=>{var N;(N=h.current)==null||N.focus()})),()=>{var N;(N=a.current)==null||N.remove()}),[]),i.exports.useLayoutEffect(()=>{if(!h.current)return;const{width:N,height:w}=Et(h.current,s,n,o);u(N),d(w)},[s,n,o]),Ve.exports.createPortal(v.exports.jsxDEV("textarea",{ref:h,className:"screenshots-textarea",style:{left:e,top:t,color:r,width:f,height:p,maxWidth:n,maxHeight:o,fontSize:c,lineHeight:`${c}px`},value:s,onChange:N=>l&&l(N.target.value),onBlur:N=>x&&x(N)},void 0,!1,{fileName:jt,lineNumber:65,columnNumber:5},this),b())}function le(e){const t=Z();i.exports.useEffect(()=>(t.on("drawselect",e),()=>{t.off("drawselect",e)}),[e,t])}var De="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Text/index.tsx";const ze={3:18,6:32,9:46};function Mt(e,t){const{size:n,color:o,fontFamily:c,x:r,y:s,text:l}=t.data;e.fillStyle=o,e.textAlign="left",e.textBaseline="top",e.font=`${n}px ${c}`;const x=t.editHistory.reduce((a,{data:h})=>({x:a.x+h.x2-h.x1,y:a.y+h.y2-h.y1}),{x:0,y:0});l.split(`
`).forEach((a,h)=>{e.fillText(a,r+x.x,s+x.y+h*n)})}function _t(e,t,n){e.textAlign="left",e.textBaseline="top",e.font=`${t.data.size}px ${t.data.fontFamily}`;let o=0,c=0;t.data.text.split(`
`).forEach(f=>{const u=e.measureText(f);o<u.width&&(o=u.width),c+=t.data.size});const{x:r,y:s}=t.editHistory.reduce((f,{data:u})=>({x:f.x+u.x2-u.x1,y:f.y+u.y2-u.y1}),{x:0,y:0}),l=t.data.x+r,x=t.data.y+s,a=l+o,h=x+c;return n.x>=l&&n.x<=a&&n.y>=x&&n.y<=h}function Vt(){const e=L(),[t,n]=X(),[o]=H(),[c,r]=I(),[,s]=O(),l=W(),[x,a]=i.exports.useState(3),[h,f]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),p=i.exports.useRef(null),[d,b]=i.exports.useState(null),[N,w]=i.exports.useState(""),C=c==="Text",z=i.exports.useCallback(()=>{r.set("Text"),s.set("default")},[r,s]),m=i.exports.useCallback(()=>{C||(z(),n.clearSelect())},[C,z,n]),g=i.exports.useCallback(B=>{u.current&&(u.current.data.size=ze[B]),a(B)},[]),y=i.exports.useCallback(B=>{u.current&&(u.current.data.color=B),f(B)},[]),k=i.exports.useCallback(B=>{w(B),C&&u.current&&(u.current.data.text=B)},[C]),S=i.exports.useCallback(()=>{u.current&&u.current.data.text&&n.push(u.current),u.current=null,w(""),b(null)},[n]),E=i.exports.useCallback((B,V)=>{B.name==="Text"&&(z(),p.current={type:j.Edit,data:{x1:V.clientX,y1:V.clientY,x2:V.clientX,y2:V.clientY},source:B},n.select(B))},[z,n]),D=i.exports.useCallback(B=>{if(!C||!l.current||u.current||!o)return;const{left:V,top:ve}=l.current.canvas.getBoundingClientRect(),be=window.getComputedStyle(l.current.canvas).fontFamily,re=B.clientX-V,ne=B.clientY-ve;u.current={name:"Text",type:j.Source,data:{size:ze[x],color:h,fontFamily:be,x:re,y:ne,text:""},editHistory:[],draw:Mt,isHit:_t},b({x:B.clientX,y:B.clientY,maxWidth:o.width-re,maxHeight:o.height-ne})},[C,x,h,o,l]),R=i.exports.useCallback(B=>{!C||p.current&&(p.current.data.x2=B.clientX,p.current.data.y2=B.clientY,t.top!==p.current?(p.current.source.editHistory.push(p.current),n.push(p.current)):n.set(t))},[C,t,n]),J=i.exports.useCallback(()=>{!C||(p.current=null)},[C]);return le(E),ee(D),te(R),se(J),v.exports.jsxDEV(v.exports.Fragment,{children:[v.exports.jsxDEV(F,{title:e.operation_text_title,icon:"icon-text",checked:C,onClick:m,option:v.exports.jsxDEV(ie,{size:x,color:h,onSizeChange:g,onColorChange:y},void 0,!1,{fileName:De,lineNumber:261,columnNumber:11},this)},void 0,!1,{fileName:De,lineNumber:255,columnNumber:7},this),C&&d&&v.exports.jsxDEV(Bt,{x:d.x,y:d.y,maxWidth:d.maxWidth,maxHeight:d.maxHeight,size:ze[x],color:h,value:N,onChange:k,onBlur:S},void 0,!1,{fileName:De,lineNumber:265,columnNumber:9},this)]},void 0,!0)}const Pe=4;function M(e,t,n){e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",e.beginPath(),e.arc(t,n,Pe,0,2*Math.PI),e.fill(),e.stroke()}function ge(e,t,n){t.draw(e,t);const{data:o}=e.getImageData(n.x,n.y,1,1);return o.some(c=>c!==0)}function _(e,t,n){if(!e)return!1;const{left:o,top:c}=e.getBoundingClientRect(),r=t.clientX-o,s=t.clientY-c;return(n.x-r)**2+(n.y-s)**2<Pe**2}function $t(e,t){const{size:n,color:o,points:c}=t.data;e.lineCap="round",e.lineJoin="round",e.lineWidth=n,e.strokeStyle=o;const r=t.editHistory.reduce((s,{data:l})=>({x:s.x+l.x2-l.x1,y:s.y+l.y2-l.y1}),{x:0,y:0});e.beginPath(),c.forEach((s,l)=>{l===0?e.moveTo(s.x+r.x,s.y+r.y):e.lineTo(s.x+r.x,s.y+r.y)}),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.beginPath(),c.forEach((s,l)=>{l===0?e.moveTo(s.x+r.x,s.y+r.y):e.lineTo(s.x+r.x,s.y+r.y)}),e.stroke())}var Te="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Brush/index.tsx";function Lt(){const e=L(),[,t]=O(),[n,o]=I(),c=W(),[r,s]=X(),[l,x]=i.exports.useState(3),[a,h]=i.exports.useState("#ee5126"),f=i.exports.useRef(null),u=i.exports.useRef(null),p=n==="Brush",d=i.exports.useCallback(()=>{o.set("Brush"),t.set("default")},[o,t]),b=i.exports.useCallback(()=>{p||(d(),s.clearSelect())},[p,d,s]),N=i.exports.useCallback((m,g)=>{m.name==="Brush"&&(d(),u.current={type:j.Edit,data:{x1:g.clientX,y1:g.clientY,x2:g.clientX,y2:g.clientY},source:m},s.select(m))},[d,s]),w=i.exports.useCallback(m=>{if(!p||f.current||!c.current)return;const{left:g,top:y}=c.current.canvas.getBoundingClientRect();f.current={name:"Brush",type:j.Source,data:{size:l,color:a,points:[{x:m.clientX-g,y:m.clientY-y}]},editHistory:[],draw:$t,isHit:ge}},[p,c,l,a]),C=i.exports.useCallback(m=>{if(!(!p||!c.current)){if(u.current)u.current.data.x2=m.clientX,u.current.data.y2=m.clientY,r.top!==u.current?(u.current.source.editHistory.push(u.current),s.push(u.current)):s.set(r);else if(f.current){const{left:g,top:y}=c.current.canvas.getBoundingClientRect();f.current.data.points.push({x:m.clientX-g,y:m.clientY-y}),r.top!==f.current?s.push(f.current):s.set(r)}}},[p,r,c,s]),z=i.exports.useCallback(()=>{!p||(f.current&&s.clearSelect(),f.current=null,u.current=null)},[p,s]);return le(N),ee(w),te(C),se(z),v.exports.jsxDEV(F,{title:e.operation_brush_title,icon:"icon-brush",checked:p,onClick:b,option:v.exports.jsxDEV(ie,{size:l,color:a,onSizeChange:x,onColorChange:h},void 0,!1,{fileName:Te,lineNumber:166,columnNumber:15},this)},void 0,!1,{fileName:Te,lineNumber:161,columnNumber:5},this)}function Ae(e){let{x1:t,y1:n,x2:o,y2:c}=e.data;return e.editHistory.forEach(({data:r})=>{const s=r.x2-r.x1,l=r.y2-r.y1;r.type===ae.Move?(t+=s,n+=l,o+=s,c+=l):r.type===ae.MoveStart?(t+=s,n+=l):r.type===ae.MoveEnd&&(o+=s,c+=l)}),pe(A({},e.data),{x1:t,x2:o,y1:n,y2:c})}function Xt(e,t){const{size:n,color:o,x1:c,x2:r,y1:s,y2:l}=Ae(t);e.lineCap="round",e.lineJoin="bevel",e.lineWidth=n,e.strokeStyle=o;const x=r-c,a=l-s,h=n*3,f=Math.atan2(a,x);e.beginPath(),e.moveTo(c,s),e.lineTo(r,l),e.lineTo(r-h*Math.cos(f-Math.PI/6),l-h*Math.sin(f-Math.PI/6)),e.moveTo(r,l),e.lineTo(r-h*Math.cos(f+Math.PI/6),l-h*Math.sin(f+Math.PI/6)),e.stroke(),t.isSelected&&(M(e,c,s),M(e,r,l))}var He="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Arrow/index.tsx",ae;(function(e){e[e.Move=0]="Move",e[e.MoveStart=1]="MoveStart",e[e.MoveEnd=2]="MoveEnd"})(ae||(ae={}));function Ft(){const e=L(),[,t]=O(),[n,o]=I(),[c,r]=X(),s=W(),[l,x]=i.exports.useState(3),[a,h]=i.exports.useState("#ee5126"),f=i.exports.useRef(null),u=i.exports.useRef(null),p=n==="Arrow",d=i.exports.useCallback(()=>{o.set("Arrow"),t.set("default")},[o,t]),b=i.exports.useCallback(()=>{p||(d(),r.clearSelect())},[p,d,r]),N=i.exports.useCallback((m,g)=>{if(m.name!=="Arrow"||!s.current)return;const y=m;d();const{x1:k,y1:S,x2:E,y2:D}=Ae(y);let R=0;_(s.current.canvas,g,{x:k,y:S})?R=1:_(s.current.canvas,g,{x:E,y:D})&&(R=2),u.current={type:j.Edit,data:{type:R,x1:g.clientX,y1:g.clientY,x2:g.clientX,y2:g.clientY},source:y},r.select(m)},[s,d,r]),w=i.exports.useCallback(m=>{if(!p||f.current||!s.current)return;const{left:g,top:y}=s.current.canvas.getBoundingClientRect();f.current={name:"Arrow",type:j.Source,data:{size:l,color:a,x1:m.clientX-g,y1:m.clientY-y,x2:m.clientX-g,y2:m.clientY-y},editHistory:[],draw:Xt,isHit:ge}},[p,a,l,s]),C=i.exports.useCallback(m=>{if(!(!p||!s.current)){if(u.current)u.current.data.x2=m.clientX,u.current.data.y2=m.clientY,c.top!==u.current?(u.current.source.editHistory.push(u.current),r.push(u.current)):r.set(c);else if(f.current){const{left:g,top:y}=s.current.canvas.getBoundingClientRect();f.current.data.x2=m.clientX-g,f.current.data.y2=m.clientY-y,c.top!==f.current?r.push(f.current):r.set(c)}}},[p,c,s,r]),z=i.exports.useCallback(()=>{!p||(f.current&&r.clearSelect(),f.current=null,u.current=null)},[p,r]);return le(N),ee(w),te(C),se(z),v.exports.jsxDEV(F,{title:e.operation_arrow_title,icon:"icon-arrow",checked:p,onClick:b,option:v.exports.jsxDEV(ie,{size:l,color:a,onSizeChange:x,onColorChange:h},void 0,!1,{fileName:He,lineNumber:190,columnNumber:15},this)},void 0,!1,{fileName:He,lineNumber:185,columnNumber:5},this)}function Oe(e){let{x1:t,y1:n,x2:o,y2:c}=e.data;return e.editHistory.forEach(({data:r})=>{const s=r.x2-r.x1,l=r.y2-r.y1;r.type===Y.Move?(t+=s,n+=l,o+=s,c+=l):r.type===Y.ResizeTop?n+=l:r.type===Y.ResizeRightTop?(o+=s,n+=l):r.type===Y.ResizeRight?o+=s:r.type===Y.ResizeRightBottom?(o+=s,c+=l):r.type===Y.ResizeBottom?c+=l:r.type===Y.ResizeLeftBottom?(t+=s,c+=l):r.type===Y.ResizeLeft?t+=s:r.type===Y.ResizeLeftTop&&(t+=s,n+=l)}),pe(A({},e.data),{x1:t,x2:o,y1:n,y2:c})}function Yt(e,t){const{size:n,color:o,x1:c,y1:r,x2:s,y2:l}=Oe(t);e.lineCap="butt",e.lineJoin="miter",e.lineWidth=n,e.strokeStyle=o;const x=(c+s)/2,a=(r+l)/2,h=Math.abs(s-c)/2,f=Math.abs(l-r)/2,u=.5522848,p=h*u,d=f*u;e.beginPath(),e.moveTo(x-h,a),e.bezierCurveTo(x-h,a-d,x-p,a-f,x,a-f),e.bezierCurveTo(x+p,a-f,x+h,a-d,x+h,a),e.bezierCurveTo(x+h,a+d,x+p,a+f,x,a+f),e.bezierCurveTo(x-p,a+f,x-h,a+d,x-h,a),e.closePath(),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",e.beginPath(),e.moveTo(c,r),e.lineTo(s,r),e.lineTo(s,l),e.lineTo(c,l),e.closePath(),e.stroke(),M(e,(c+s)/2,r),M(e,s,r),M(e,s,(r+l)/2),M(e,s,l),M(e,(c+s)/2,l),M(e,c,l),M(e,c,(r+l)/2),M(e,c,r))}var Ie="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Ellipse/index.tsx",Y;(function(e){e[e.Move=0]="Move",e[e.ResizeTop=1]="ResizeTop",e[e.ResizeRightTop=2]="ResizeRightTop",e[e.ResizeRight=3]="ResizeRight",e[e.ResizeRightBottom=4]="ResizeRightBottom",e[e.ResizeBottom=5]="ResizeBottom",e[e.ResizeLeftBottom=6]="ResizeLeftBottom",e[e.ResizeLeft=7]="ResizeLeft",e[e.ResizeLeftTop=8]="ResizeLeftTop"})(Y||(Y={}));function Pt(){const e=L(),[t,n]=X(),[o,c]=I(),[,r]=O(),s=W(),[l,x]=i.exports.useState(3),[a,h]=i.exports.useState("#ee5126"),f=i.exports.useRef(null),u=i.exports.useRef(null),p=o==="Ellipse",d=i.exports.useCallback(()=>{c.set("Ellipse"),r.set("crosshair")},[c,r]),b=i.exports.useCallback(()=>{p||(d(),n.clearSelect())},[p,d,n]),N=i.exports.useCallback((m,g)=>{if(m.name!=="Ellipse"||!s.current)return;const y=m;d();const{x1:k,y1:S,x2:E,y2:D}=Oe(y);let R=0;_(s.current.canvas,g,{x:(k+E)/2,y:S})?R=1:_(s.current.canvas,g,{x:E,y:S})?R=2:_(s.current.canvas,g,{x:E,y:(S+D)/2})?R=3:_(s.current.canvas,g,{x:E,y:D})?R=4:_(s.current.canvas,g,{x:(k+E)/2,y:D})?R=5:_(s.current.canvas,g,{x:k,y:D})?R=6:_(s.current.canvas,g,{x:k,y:(S+D)/2})?R=7:_(s.current.canvas,g,{x:k,y:S})&&(R=8),u.current={type:j.Edit,data:{type:R,x1:g.clientX,y1:g.clientY,x2:g.clientX,y2:g.clientY},source:y},n.select(m)},[s,d,n]),w=i.exports.useCallback(m=>{if(!p||!s.current||f.current)return;const{left:g,top:y}=s.current.canvas.getBoundingClientRect(),k=m.clientX-g,S=m.clientY-y;f.current={name:"Ellipse",type:j.Source,data:{size:l,color:a,x1:k,y1:S,x2:k,y2:S},editHistory:[],draw:Yt,isHit:ge}},[p,l,a,s]),C=i.exports.useCallback(m=>{if(!(!p||!s.current)){if(u.current)u.current.data.x2=m.clientX,u.current.data.y2=m.clientY,t.top!==u.current?(u.current.source.editHistory.push(u.current),n.push(u.current)):n.set(t);else if(f.current){const{left:g,top:y}=s.current.canvas.getBoundingClientRect();f.current.data.x2=m.clientX-g,f.current.data.y2=m.clientY-y,t.top!==f.current?n.push(f.current):n.set(t)}}},[p,s,t,n]),z=i.exports.useCallback(()=>{!p||(f.current&&n.clearSelect(),f.current=null,u.current=null)},[p,n]);return le(N),ee(w),te(C),se(z),v.exports.jsxDEV(F,{title:e.operation_ellipse_title,icon:"icon-ellipse",checked:p,onClick:b,option:v.exports.jsxDEV(ie,{size:l,color:a,onSizeChange:x,onColorChange:h},void 0,!1,{fileName:Ie,lineNumber:242,columnNumber:15},this)},void 0,!1,{fileName:Ie,lineNumber:237,columnNumber:5},this)}function We(e){let{x1:t,y1:n,x2:o,y2:c}=e.data;return e.editHistory.forEach(({data:r})=>{const s=r.x2-r.x1,l=r.y2-r.y1;r.type===P.Move?(t+=s,n+=l,o+=s,c+=l):r.type===P.ResizeTop?n+=l:r.type===P.ResizeRightTop?(o+=s,n+=l):r.type===P.ResizeRight?o+=s:r.type===P.ResizeRightBottom?(o+=s,c+=l):r.type===P.ResizeBottom?c+=l:r.type===P.ResizeLeftBottom?(t+=s,c+=l):r.type===P.ResizeLeft?t+=s:r.type===P.ResizeLeftTop&&(t+=s,n+=l)}),pe(A({},e.data),{x1:t,x2:o,y1:n,y2:c})}function Tt(e,t){const{size:n,color:o,x1:c,y1:r,x2:s,y2:l}=We(t);e.lineCap="butt",e.lineJoin="miter",e.lineWidth=n,e.strokeStyle=o,e.beginPath(),e.moveTo(c,r),e.lineTo(s,r),e.lineTo(s,l),e.lineTo(c,l),e.closePath(),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",M(e,(c+s)/2,r),M(e,s,r),M(e,s,(r+l)/2),M(e,s,l),M(e,(c+s)/2,l),M(e,c,l),M(e,c,(r+l)/2),M(e,c,r))}var Ue="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Rectangle/index.tsx",P;(function(e){e[e.Move=0]="Move",e[e.ResizeTop=1]="ResizeTop",e[e.ResizeRightTop=2]="ResizeRightTop",e[e.ResizeRight=3]="ResizeRight",e[e.ResizeRightBottom=4]="ResizeRightBottom",e[e.ResizeBottom=5]="ResizeBottom",e[e.ResizeLeftBottom=6]="ResizeLeftBottom",e[e.ResizeLeft=7]="ResizeLeft",e[e.ResizeLeftTop=8]="ResizeLeftTop"})(P||(P={}));function At(){const e=L(),[t,n]=X(),[o,c]=I(),[,r]=O(),s=W(),[l,x]=i.exports.useState(3),[a,h]=i.exports.useState("#ee5126"),f=i.exports.useRef(null),u=i.exports.useRef(null),p=o==="Rectangle",d=i.exports.useCallback(()=>{c.set("Rectangle"),r.set("crosshair")},[c,r]),b=i.exports.useCallback(()=>{p||(d(),n.clearSelect())},[p,d,n]),N=i.exports.useCallback((m,g)=>{if(m.name!=="Rectangle"||!s.current)return;const y=m;d();const{x1:k,y1:S,x2:E,y2:D}=We(y);let R=0;_(s.current.canvas,g,{x:(k+E)/2,y:S})?R=1:_(s.current.canvas,g,{x:E,y:S})?R=2:_(s.current.canvas,g,{x:E,y:(S+D)/2})?R=3:_(s.current.canvas,g,{x:E,y:D})?R=4:_(s.current.canvas,g,{x:(k+E)/2,y:D})?R=5:_(s.current.canvas,g,{x:k,y:D})?R=6:_(s.current.canvas,g,{x:k,y:(S+D)/2})?R=7:_(s.current.canvas,g,{x:k,y:S})&&(R=8),u.current={type:j.Edit,data:{type:R,x1:g.clientX,y1:g.clientY,x2:g.clientX,y2:g.clientY},source:m},n.select(m)},[s,d,n]),w=i.exports.useCallback(m=>{if(!p||!s.current||f.current)return;const{left:g,top:y}=s.current.canvas.getBoundingClientRect(),k=m.clientX-g,S=m.clientY-y;f.current={name:"Rectangle",type:j.Source,data:{size:l,color:a,x1:k,y1:S,x2:k,y2:S},editHistory:[],draw:Tt,isHit:ge}},[p,l,a,s]),C=i.exports.useCallback(m=>{if(!(!p||!s.current)){if(u.current)u.current.data.x2=m.clientX,u.current.data.y2=m.clientY,t.top!==u.current?(u.current.source.editHistory.push(u.current),n.push(u.current)):n.set(t);else if(f.current){const{left:g,top:y}=s.current.canvas.getBoundingClientRect(),k=f.current.data;k.x2=m.clientX-g,k.y2=m.clientY-y,t.top!==f.current?n.push(f.current):n.set(t)}}},[p,s,t,n]),z=i.exports.useCallback(()=>{!p||(f.current&&n.clearSelect(),f.current=null,u.current=null)},[p,n]);return le(N),ee(w),te(C),se(z),v.exports.jsxDEV(F,{title:e.operation_rectangle_title,icon:"icon-rectangle",checked:p,onClick:b,option:v.exports.jsxDEV(ie,{size:l,color:a,onSizeChange:x,onColorChange:h},void 0,!1,{fileName:Ue,lineNumber:242,columnNumber:15},this)},void 0,!1,{fileName:Ue,lineNumber:237,columnNumber:5},this)}var Ht=[At,Pt,Ft,Lt,Vt,Rt,"|",kt,yt,"|",vt,dt,mt];var ue="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsOperations/index.tsx";const Je=_e.createContext(null);function Ot(){const{width:e,height:t}=$(),[n]=H(),[o,c]=i.exports.useState(null),[r,s]=i.exports.useState(null),l=i.exports.useRef(null),x=i.exports.useCallback(h=>{h.stopPropagation()},[]),a=i.exports.useCallback(h=>{h.preventDefault(),h.stopPropagation()},[]);return i.exports.useEffect(()=>{if(!n||!l.current)return;const h=l.current.getBoundingClientRect();let f=n.x+n.width-h.width,u=n.y+n.height+10;f<0&&(f=0),f>e-h.width&&(f=e-h.width),u>t-h.height&&(u=t-h.height-10),((r==null?void 0:r.x)!==f||r.y!==u)&&s({x:f,y:u}),((o==null?void 0:o.x)!==h.x||o.y!==h.y||o.width!==h.width||o.height!==h.height)&&c({x:h.x,y:h.y,width:h.width,height:h.height})}),n?v.exports.jsxDEV(Je.Provider,{value:o,children:v.exports.jsxDEV("div",{ref:l,className:"screenshots-operations",style:{visibility:r?"visible":"hidden",left:r==null?void 0:r.x,top:r==null?void 0:r.y},onDoubleClick:x,onContextMenu:a,children:v.exports.jsxDEV("div",{className:"screenshots-operations-buttons",children:Ht.map((h,f)=>h==="|"?v.exports.jsxDEV("div",{className:"screenshots-operations-divider"},f,!1,{fileName:ue,lineNumber:91,columnNumber:22},this):v.exports.jsxDEV(h,{},f,!1,{fileName:ue,lineNumber:93,columnNumber:22},this))},void 0,!1,{fileName:ue,lineNumber:88,columnNumber:9},this)},void 0,!1,{fileName:ue,lineNumber:77,columnNumber:7},this)},void 0,!1,{fileName:ue,lineNumber:76,columnNumber:5},this):null}function It(e){const[t,n]=i.exports.useState(null);return i.exports.useEffect(()=>{if(n(null),e==null)return;const o=document.createElement("img"),c=()=>n(o),r=()=>n(null);return o.addEventListener("load",c),o.addEventListener("error",r),o.src=e,()=>{o.removeEventListener("load",c),o.removeEventListener("error",r)}},[e]),t}var fe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/index.tsx";function Wt(s){var l=s,{url:e,width:t,height:n,lang:o,className:c}=l,r=Me(l,["url","width","height","lang","className"]);const x=It(e),a=i.exports.useRef(null),h=i.exports.useRef({}),[f,u]=i.exports.useState({index:-1,stack:[]}),[p,d]=i.exports.useState(null),[b,N]=i.exports.useState("move"),[w,C]=i.exports.useState(void 0),z={url:e,width:t,height:n,image:x,lang:A(A({},$e),o),emiterRef:h,canvasContextRef:a,history:f,bounds:p,cursor:b,operation:w},m=i.exports.useCallback((D,...R)=>{const J=r[D];typeof J=="function"&&J(...R)},[r]),g={call:m,setHistory:u,setBounds:d,setCursor:N,setOperation:C},y=["screenshots"];c&&y.push(c);const k=()=>{h.current={},u({index:-1,stack:[]}),d(null),N("move"),C(void 0)},S=i.exports.useCallback(D=>{D.button!==0||!p||!a.current||a.current.canvas.toBlob(R=>{m("onOk",R,p),k()},"image/png")},[p,m]),E=i.exports.useCallback(D=>{D.button===2&&(D.preventDefault(),m("onCancel"),k())},[m]);return i.exports.useLayoutEffect(()=>{k()},[e]),v.exports.jsxDEV(ye.Provider,{value:{store:z,dispatcher:g},children:v.exports.jsxDEV("div",{className:y.join(" "),style:{width:t,height:n},onDoubleClick:S,onContextMenu:E,children:[v.exports.jsxDEV(ot,{},void 0,!1,{fileName:fe,lineNumber:123,columnNumber:9},this),v.exports.jsxDEV(ft,{ref:a},void 0,!1,{fileName:fe,lineNumber:124,columnNumber:9},this),v.exports.jsxDEV(Ot,{},void 0,!1,{fileName:fe,lineNumber:125,columnNumber:9},this)]},void 0,!0,{fileName:fe,lineNumber:117,columnNumber:7},this)},void 0,!1,{fileName:fe,lineNumber:116,columnNumber:5},this)}var Ut="./assets/image.82ad6a18.png",qe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/web/app.tsx";function Jt(){const e=i.exports.useCallback((o,c)=>{console.log("save",o,c),console.log(o&&URL.createObjectURL(o))},[]),t=i.exports.useCallback(()=>{console.log("cancel")},[]),n=i.exports.useCallback((o,c)=>{console.log("ok",o,c),console.log(o&&URL.createObjectURL(o))},[]);return v.exports.jsxDEV("div",{className:"body",children:v.exports.jsxDEV(Wt,{url:Ut,width:window.innerWidth,height:window.innerHeight,lang:{operation_rectangle_title:"Rectangle"},onSave:e,onCancel:t,onOk:n},void 0,!1,{fileName:qe,lineNumber:22,columnNumber:7},this)},void 0,!1,{fileName:qe,lineNumber:21,columnNumber:5},this)}var Ge="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/web/index.tsx";tt.render(v.exports.jsxDEV(i.exports.StrictMode,{children:v.exports.jsxDEV(Jt,{},void 0,!1,{fileName:Ge,lineNumber:7,columnNumber:5},globalThis)},void 0,!1,{fileName:Ge,lineNumber:6,columnNumber:3},globalThis),document.getElementById("app"));
