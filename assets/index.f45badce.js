var qe=Object.defineProperty,Ge=Object.defineProperties;var Qe=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var je=(e,t,n)=>t in e?qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,A=(e,t)=>{for(var n in t||(t={}))ze.call(t,n)&&je(e,n,t[n]);if(he)for(var n of he(t))Ee.call(t,n)&&je(e,n,t[n]);return e},me=(e,t)=>Ge(e,Qe(t));var Be=(e,t)=>{var n={};for(var o in e)ze.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&he)for(var o of he(e))t.indexOf(o)<0&&Ee.call(e,o)&&(n[o]=e[o]);return n};import{R as Me,r as i,j as v,a as _e,b as Ke}from"./vendor.44b7eecb.js";const Ze=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const s of c)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(c){const s={};return c.integrity&&(s.integrity=c.integrity),c.referrerpolicy&&(s.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?s.credentials="include":c.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(c){if(c.ep)return;c.ep=!0;const s=n(c);fetch(c.href,s)}};Ze();function et(e,{width:t,height:n}){return new Promise((o,c)=>{if(!e.complete)return c(new Error("image is not fully loaded"));const s=document.createElement("canvas"),r=t*window.devicePixelRatio,l=n*window.devicePixelRatio;s.width=r,s.height=l;const p=s.getContext("2d");if(!p)return c(new Error("convert image to blob fail"));p.imageSmoothingEnabled=!0,p.imageSmoothingQuality="low",p.drawImage(e,0,0,e.naturalWidth,e.naturalHeight,0,0,r,l),s.toBlob(a=>{if(!a)return c(new Error("canvas toBlob fail"));o(a)},"image/png")})}const Ve={magnifier_position_label:"\u5750\u6807",operation_ok_title:"\u786E\u5B9A",operation_cancel_title:"\u53D6\u6D88",operation_save_title:"\u4FDD\u5B58",operation_redo_title:"\u91CD\u505A",operation_undo_title:"\u64A4\u9500",operation_mosaic_title:"\u9A6C\u8D5B\u514B",operation_text_title:"\u6587\u672C",operation_brush_title:"\u753B\u7B14",operation_arrow_title:"\u7BAD\u5934",operation_ellipse_title:"\u692D\u5706",operation_rectangle_title:"\u77E9\u5F62"};var be=Me.createContext({store:{url:void 0,image:null,width:0,height:0,lang:Ve,emiterRef:{current:{}},canvasContextRef:{current:null},history:{index:-1,stack:[]},bounds:null,cursor:"move",operation:void 0},dispatcher:{call:void 0,setHistory:void 0,setBounds:void 0,setCursor:void 0,setOperation:void 0}});function oe(){const{dispatcher:e}=i.exports.useContext(be);return e}function $(){const{store:e}=i.exports.useContext(be);return e}function H(){const{bounds:e}=$(),{setBounds:t}=oe(),n=i.exports.useCallback(c=>{t==null||t(c)},[t]),o=i.exports.useCallback(()=>{t==null||t(null)},[t]);return[e,{set:n,reset:o}]}function L(){const{lang:e}=$();return e}var G="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsMagnifier/index.tsx";const Q=100,K=80;function tt({x:e,y:t}){const{width:n,height:o,image:c}=$(),s=L(),[r,l]=i.exports.useState(null),p=i.exports.useRef(null),a=i.exports.useRef(null),h=i.exports.useRef(null),[u,f]=i.exports.useState("000000");return i.exports.useLayoutEffect(()=>{if(!p.current)return;const m=p.current.getBoundingClientRect();let g=e+20,b=t+20;g+m.width>n&&(g=e-m.width-20),b+m.height>o&&(b=t-m.height-20),g<0&&(g=0),b<0&&(b=0),l({x:g,y:b})},[n,o,e,t]),i.exports.useEffect(()=>{if(!c||!a.current){h.current=null;return}if(h.current||(h.current=a.current.getContext("2d")),!h.current)return;const m=h.current;m.clearRect(0,0,Q,K);const g=c.naturalWidth/n,b=c.naturalHeight/o;m.drawImage(c,e*g-Q/2,t*b-K/2,Q,K,0,0,Q,K);const{data:N}=m.getImageData(Math.floor(Q/2),Math.floor(K/2),1,1),S=Array.from(N.slice(0,3)).map(C=>C>=16?C.toString(16):`0${C.toString(16)}`).join("").toUpperCase();f(S)},[n,o,c,e,t]),v.exports.jsxDEV("div",{ref:p,className:"screenshots-magnifier",style:{transform:`translate(${r==null?void 0:r.x}px, ${r==null?void 0:r.y}px)`},children:[v.exports.jsxDEV("div",{className:"screenshots-magnifier-body",children:v.exports.jsxDEV("canvas",{ref:a,className:"screenshots-magnifier-body-canvas",width:Q,height:K},void 0,!1,{fileName:G,lineNumber:97,columnNumber:9},this)},void 0,!1,{fileName:G,lineNumber:96,columnNumber:7},this),v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer",children:[v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer-item",children:[s.magnifier_position_label,": (",e,",",t,")"]},void 0,!0,{fileName:G,lineNumber:105,columnNumber:9},this),v.exports.jsxDEV("div",{className:"screenshots-magnifier-footer-item",children:["RGB: #",u]},void 0,!0,{fileName:G,lineNumber:108,columnNumber:9},this)]},void 0,!0,{fileName:G,lineNumber:104,columnNumber:7},this)]},void 0,!0,{fileName:G,lineNumber:89,columnNumber:5},this)}function st({x:e,y:t},{x:n,y:o},c,s){return e>n&&([e,n]=[n,e]),t>o&&([t,o]=[o,t]),e<0&&(e=0),n>c&&(n=c),t<0&&(t=0),o>s&&(o=s),{x:e,y:t,width:n-e,height:o-t}}var pe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsBackground/index.tsx";function rt(){const{url:e,image:t,width:n,height:o}=$(),[c,s]=H(),r=i.exports.useRef(null),l=i.exports.useRef(null),p=i.exports.useRef(!1),[a,h]=i.exports.useState(null),u=i.exports.useCallback((m,g)=>{if(!r.current)return;const{x:b,y:N}=r.current.getBoundingClientRect();s.set(st({x:m.x-b,y:m.y-N},{x:g.x-b,y:g.y-N},n,o))},[n,o,s]),f=i.exports.useCallback(m=>{l.current||c||m.button!==0||(l.current={x:m.clientX,y:m.clientY},p.current=!1)},[c]);return i.exports.useEffect(()=>{const m=b=>{if(r.current){const N=r.current.getBoundingClientRect();b.clientX<N.left||b.clientY<N.top||b.clientX>N.right||b.clientY>N.bottom?h(null):h({x:b.clientX-N.x,y:b.clientY-N.y})}!l.current||(u(l.current,{x:b.clientX,y:b.clientY}),p.current=!0)},g=b=>{!l.current||(p.current&&u(l.current,{x:b.clientX,y:b.clientY}),l.current=null,p.current=!1)};return window.addEventListener("mousemove",m),window.addEventListener("mouseup",g),()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",g)}},[u]),i.exports.useLayoutEffect(()=>{(!t||c)&&h(null)},[t,c]),!e||!t?null:v.exports.jsxDEV("div",{ref:r,className:"screenshots-background",onMouseDown:f,children:[v.exports.jsxDEV("img",{className:"screenshots-background-image",src:e},void 0,!1,{fileName:pe,lineNumber:121,columnNumber:7},this),v.exports.jsxDEV("div",{className:"screenshots-background-mask"},void 0,!1,{fileName:pe,lineNumber:122,columnNumber:7},this),a&&!c&&v.exports.jsxDEV(tt,{x:a==null?void 0:a.x,y:a==null?void 0:a.y},void 0,!1,{fileName:pe,lineNumber:123,columnNumber:31},this)]},void 0,!0,{fileName:pe,lineNumber:120,columnNumber:5},this)}function O(){const{cursor:e}=$(),{setCursor:t}=oe(),n=i.exports.useCallback(c=>{t==null||t(c)},[t]),o=i.exports.useCallback(()=>{t==null||t("move")},[t]);return[e,{set:n,reset:o}]}function Z(){const{emiterRef:e}=$(),t=i.exports.useCallback((s,r)=>{const l=e.current;Array.isArray(l[s])?l[s].push(r):l[s]=[r]},[e]),n=i.exports.useCallback((s,r)=>{const l=e.current;if(Array.isArray(l[s])){const p=l[s].findIndex(a=>a===r);p!==-1&&l[s].splice(p,1)}},[e]),o=i.exports.useCallback((s,...r)=>{const l=e.current;Array.isArray(l[s])&&l[s].forEach(p=>p(...r))},[e]),c=i.exports.useCallback(()=>{e.current={}},[e]);return{on:t,off:n,emit:o,reset:c}}var j;(function(e){e[e.Edit=0]="Edit",e[e.Source=1]="Source"})(j||(j={}));function P(){const{history:e}=$(),{setHistory:t}=oe(),n=i.exports.useCallback(h=>{const{index:u,stack:f}=e;f.forEach(m=>{m.type===j.Source&&(m.isSelected=!1)}),h.type===j.Source?h.isSelected=!0:h.type===j.Edit&&(h.source.isSelected=!0),f.splice(u+1),f.push(h),t==null||t({index:f.length-1,stack:f})},[e,t]),o=i.exports.useCallback(()=>{const{stack:h}=e;h.pop(),t==null||t({index:h.length-1,stack:h})},[e,t]),c=i.exports.useCallback(()=>{const{index:h,stack:u}=e,f=u[h];f&&(f.type===j.Source?f.isSelected=!1:f.type===j.Edit&&f.source.editHistory.pop()),t==null||t({index:h<=0?-1:h-1,stack:u})},[e,t]),s=i.exports.useCallback(()=>{const{index:h,stack:u}=e,f=u[h+1];f&&(f.type===j.Source?f.isSelected=!1:f.type===j.Edit&&f.source.editHistory.push(f)),t==null||t({index:h>=u.length-1?u.length-1:h+1,stack:u})},[e,t]),r=i.exports.useCallback(h=>{t==null||t(A({},h))},[t]),l=i.exports.useCallback(h=>{e.stack.forEach(u=>{u.type===j.Source&&(u===h?u.isSelected=!0:u.isSelected=!1)}),t==null||t(A({},e))},[e,t]),p=i.exports.useCallback(()=>{e.stack.forEach(h=>{h.type===j.Source&&(h.isSelected=!1)}),t==null||t(A({},e))},[e,t]),a=i.exports.useCallback(()=>{t==null||t({index:-1,stack:[]})},[t]);return[{index:e.index,stack:e.stack,top:e.stack.slice(e.index,e.index+1)[0]},{push:n,pop:o,undo:c,redo:s,set:r,select:l,clearSelect:p,reset:a}]}function I(){const{operation:e}=$(),{setOperation:t}=oe(),n=i.exports.useCallback(c=>{t==null||t(c)},[t]),o=i.exports.useCallback(()=>{t==null||t(void 0)},[t]);return[e,{set:n,reset:o}]}function nt({x:e,y:t},{x:n,y:o},c,s,r,l){return e>n&&([e,n]=[n,e]),t>o&&([t,o]=[o,t]),e<0&&(e=0,l==="move"&&(n=c.width)),n>s&&(n=s,l==="move"&&(e=n-c.width)),t<0&&(t=0,l==="move"&&(o=c.height)),o>r&&(o=r,l==="move"&&(t=o-c.height)),{x:e,y:t,width:Math.max(n-e,1),height:Math.max(o-t,1)}}function ot(e,t,n,o){const c=e.clientX-n.x,s=e.clientY-n.y;let r=o.x,l=o.y,p=o.x+o.width,a=o.y+o.height;switch(t){case"top":l+=s;break;case"top-right":p+=c,l+=s;break;case"right":p+=c;break;case"right-bottom":p+=c,a+=s;break;case"bottom":a+=s;break;case"bottom-left":r+=c,a+=s;break;case"left":r+=c;break;case"left-top":r+=c,l+=s;break;case"move":r+=c,l+=s,p+=c,a+=s;break}return[{x:r,y:l},{x:p,y:a}]}function ct(e,t,n,o){if(!t)return!1;const c=document.createElement("canvas");c.width=e.width,c.height=e.height;const s=c.getContext("2d");if(!s)return!1;const{left:r,top:l}=t.getBoundingClientRect(),p=o.clientX-r,a=o.clientY-l;return[...n.stack.slice(0,n.index+1)].reverse().find(u=>{var f;return u.type!==j.Source?!1:(s.clearRect(0,0,e.width,e.height),(f=u.isHit)==null?void 0:f.call(u,s,u,{x:p,y:a}))})}var ce="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsCanvas/index.tsx";const it=["top","right","bottom","left"];var T;(function(e){e.ResizeTop="top",e.ResizetopRight="top-right",e.ResizeRight="right",e.ResizeRightBottom="right-bottom",e.ResizeBottom="bottom",e.ResizeBottomLeft="bottom-left",e.ResizeLeft="left",e.ResizeLeftTop="left-top",e.Move="move"})(T||(T={}));const lt=[T.ResizeTop,T.ResizetopRight,T.ResizeRight,T.ResizeRightBottom,T.ResizeBottom,T.ResizeBottomLeft,T.ResizeLeft,T.ResizeLeftTop];var at=i.exports.forwardRef(function(t,n){const{image:o,width:c,height:s}=$(),r=Z(),[l]=P(),[p]=O(),[a,h]=H(),[u]=I(),f=i.exports.useRef(),m=i.exports.useRef(null),g=i.exports.useRef(null),b=i.exports.useRef(null),N=i.exports.useRef(null),S=i.exports.useCallback(()=>{if(!o||!a||!N.current)return;const x=o.naturalWidth/c,d=o.naturalHeight/s,y=N.current;y.imageSmoothingEnabled=!0,y.imageSmoothingQuality="low",y.setTransform(window.devicePixelRatio,0,0,window.devicePixelRatio,0,0),y.clearRect(0,0,a.width,a.height),y.drawImage(o,a.x*x,a.y*d,a.width*x,a.height*d,0,0,a.width,a.height),l.stack.slice(0,l.index+1).forEach(k=>{k.type===j.Source&&k.draw(y,k)})},[o,c,s,a,N,l]),C=i.exports.useCallback((x,d)=>{if(!(x.button!==0||!a))if(!u)f.current=d,m.current={x:x.clientX,y:x.clientY},g.current={x:a.x,y:a.y,width:a.width,height:a.height};else{const y=ct(a,b.current,l,x.nativeEvent);y?r.emit("drawselect",y,x.nativeEvent):r.emit("mousedown",x.nativeEvent)}},[a,u,r,l]),z=i.exports.useCallback(x=>{if(!f.current||!m.current||!g.current||!a)return;const d=ot(x,f.current,m.current,g.current);h.set(nt(d[0],d[1],a,c,s,f.current))},[c,s,a,h]);return i.exports.useLayoutEffect(()=>{if(!o||!a||!b.current){N.current=null;return}N.current||(N.current=b.current.getContext("2d")),S()},[o,a,S]),i.exports.useEffect(()=>{const x=y=>{if(u)r.emit("mousemove",y);else{if(!f.current||!m.current||!g.current)return;z(y)}},d=y=>{if(u)r.emit("mouseup",y);else{if(!f.current||!m.current||!g.current)return;z(y),f.current=void 0,m.current=null,g.current=null}};return window.addEventListener("mousemove",x),window.addEventListener("mouseup",d),()=>{window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",d)}},[z,u,r]),i.exports.useImperativeHandle(n,()=>N.current),a?v.exports.jsxDEV("div",{className:"screenshots-canvas",style:{left:a.x,top:a.y,width:a.width,height:a.height},children:[v.exports.jsxDEV("canvas",{ref:b,width:a.width*window.devicePixelRatio,height:a.height*window.devicePixelRatio,style:{width:a.width,height:a.height}},void 0,!1,{fileName:ce,lineNumber:199,columnNumber:7},this),v.exports.jsxDEV("div",{className:"screenshots-canvas-body",style:{cursor:p},onMouseDown:x=>C(x,"move")},void 0,!1,{fileName:ce,lineNumber:208,columnNumber:7},this),it.map(x=>v.exports.jsxDEV("div",{className:`screenshots-canvas-border-${x}`},x,!1,{fileName:ce,lineNumber:216,columnNumber:16},this)),lt.map(x=>v.exports.jsxDEV("div",{className:`screenshots-canvas-point-${x}`,onMouseDown:d=>C(d,x)},x,!1,{fileName:ce,lineNumber:220,columnNumber:11},this))]},void 0,!0,{fileName:ce,lineNumber:190,columnNumber:5},this):null});function ye(){const e=oe();return i.exports.useCallback((n,...o)=>{var c;(c=e.call)==null||c.call(e,n,...o)},[e])}function W(){const{canvasContextRef:e}=$();return e}function Ne(){const e=Z(),[,t]=H(),[,n]=O(),[,o]=P(),[,c]=I();return i.exports.useCallback(()=>{e.reset(),o.reset(),t.reset(),n.reset(),c.reset()},[e,o,t,n,c])}var ke="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsOption/index.tsx",q;(function(e){e.Bottom="bottom",e.Top="top"})(q||(q={}));function ut({open:e,content:t,children:n}){const o=i.exports.useRef(null),c=i.exports.useRef(null),s=i.exports.useRef(null),r=i.exports.useContext(We),[l,p]=i.exports.useState(q.Bottom),[a,h]=i.exports.useState(null),[u,f]=i.exports.useState(0),m=()=>(c.current||(c.current=document.createElement("div")),c.current);return i.exports.useEffect(()=>{const g=m();return e&&document.body.appendChild(g),()=>{g.remove()}},[e]),i.exports.useEffect(()=>{if(!e||!r||!o.current||!s.current)return;const g=o.current.getBoundingClientRect(),b=s.current.getBoundingClientRect();let N=l,S=g.left+g.width/2,C=g.top+g.height,z=u;if(S+b.width/2>r.x+r.width){const x=S;S=r.x+r.width-b.width/2,z=x-S}if(S<r.x+b.width/2){const x=S;S=r.x+b.width/2,z=x-S}C>window.innerHeight-b.height&&(N===q.Bottom&&(N=q.Top),C=g.top-b.height),C<0&&(N===q.Top&&(N=q.Bottom),C=g.top+g.height),N!==l&&p(N),((a==null?void 0:a.x)!==S||a.y!==C)&&h({x:S,y:C}),z!==u&&f(z)}),v.exports.jsxDEV(v.exports.Fragment,{children:[i.exports.cloneElement(n,{ref:o}),e&&t&&_e.exports.createPortal(v.exports.jsxDEV("div",{ref:s,className:"screenshots-option",style:{visibility:a?"visible":"hidden",left:a==null?void 0:a.x,top:a==null?void 0:a.y},"data-placement":l,children:[v.exports.jsxDEV("div",{className:"screenshots-option-container",children:t},void 0,!1,{fileName:ke,lineNumber:121,columnNumber:13},this),v.exports.jsxDEV("div",{className:"screenshots-option-arrow",style:{marginLeft:u}},void 0,!1,{fileName:ke,lineNumber:122,columnNumber:13},this)]},void 0,!0,{fileName:ke,lineNumber:111,columnNumber:11},this),m())]},void 0,!0)}var Ce="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsButton/index.tsx";function X({title:e,icon:t,checked:n,disabled:o,option:c,onClick:s}){const r=["screenshots-button"],l=i.exports.useCallback(p=>{o||!s||s(p)},[o,s]);return n&&r.push("screenshots-button-checked"),o&&r.push("screenshots-button-disabled"),v.exports.jsxDEV(ut,{open:n,content:c,children:v.exports.jsxDEV("div",{className:r.join(" "),title:e,onClick:l,children:v.exports.jsxDEV("span",{className:t},void 0,!1,{fileName:Ce,lineNumber:44,columnNumber:9},this)},void 0,!1,{fileName:Ce,lineNumber:43,columnNumber:7},this)},void 0,!1,{fileName:Ce,lineNumber:42,columnNumber:5},this)}var ft="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Ok/index.tsx";function ht(){const e=L(),t=W(),[,n]=P(),o=ye(),[c]=H(),s=Ne(),r=i.exports.useCallback(()=>{n.clearSelect(),setTimeout(()=>{!t.current||t.current.canvas.toBlob(l=>{o("onOk",l,c),s()},"image/png")})},[t,n,o,c,s]);return v.exports.jsxDEV(X,{title:e.operation_ok_title,icon:"icon-ok",onClick:r},void 0,!1,{fileName:ft,lineNumber:31,columnNumber:10},this)}var mt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Cancel/index.tsx";function pt(){const e=ye(),t=Ne(),n=L(),o=i.exports.useCallback(()=>{e("onCancel"),t()},[e,t]);return v.exports.jsxDEV(X,{title:n.operation_cancel_title,icon:"icon-cancel",onClick:o},void 0,!1,{fileName:mt,lineNumber:17,columnNumber:10},this)}var xt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Save/index.tsx";function dt(){const e=L(),t=W(),[,n]=P(),[o]=H(),c=ye(),s=Ne(),r=i.exports.useCallback(()=>{n.clearSelect(),setTimeout(()=>{!t.current||t.current.canvas.toBlob(l=>{c("onSave",l,o),s()},"image/png")})},[t,n,o,c,s]);return v.exports.jsxDEV(X,{title:e.operation_save_title,icon:"icon-save",onClick:r},void 0,!1,{fileName:xt,lineNumber:31,columnNumber:10},this)}var gt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Redo/index.tsx";function vt(){const e=L(),[t,n]=P(),o=i.exports.useCallback(()=>{n.redo()},[n]);return v.exports.jsxDEV(X,{title:e.operation_redo_title,icon:"icon-redo",disabled:!t.stack.length||t.stack.length-1===t.index,onClick:o},void 0,!1,{fileName:gt,lineNumber:15,columnNumber:5},this)}var bt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Undo/index.tsx";function yt(){const e=L(),[t,n]=P(),o=i.exports.useCallback(()=>{n.undo()},[n]);return v.exports.jsxDEV(X,{title:e.operation_undo_title,icon:"icon-undo",disabled:t.index===-1,onClick:o},void 0,!1,{fileName:bt,lineNumber:15,columnNumber:5},this)}var Re="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsSize/index.tsx";function $e({value:e,onChange:t}){const n=[3,6,9];return v.exports.jsxDEV("div",{className:"screenshots-size",children:n.map(o=>{const c=["screenshots-size-item"];return o===e&&c.push("screenshots-size-active"),v.exports.jsxDEV("div",{className:c.join(" "),onClick:()=>t&&t(o),children:v.exports.jsxDEV("div",{className:"screenshots-size-pointer",style:{width:o*1.8,height:o*1.8}},void 0,!1,{fileName:Re,lineNumber:22,columnNumber:13},this)},o,!1,{fileName:Re,lineNumber:21,columnNumber:11},this)})},void 0,!1,{fileName:Re,lineNumber:12,columnNumber:5},this)}function ee(e){const t=Z();i.exports.useEffect(()=>(t.on("mousedown",e),()=>{t.off("mousedown",e)}),[e,t])}function te(e){const t=Z();i.exports.useEffect(()=>(t.on("mousemove",e),()=>{t.off("mousemove",e)}),[e,t])}function se(e){const t=Z();i.exports.useEffect(()=>(t.on("mouseup",e),()=>{t.off("mouseup",e)}),[e,t])}var Le="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Mosaic/index.tsx";function xe(e,t,n){if(!n)return[0,0,0,0];const{data:o,width:c}=n,s=t*c*4+e*4;return Array.from(o.slice(s,s+4))}function Nt(e,t){const{tiles:n,size:o}=t.data;n.forEach(c=>{const s=Math.round(c.color[0]),r=Math.round(c.color[1]),l=Math.round(c.color[2]),p=c.color[3]/255;e.fillStyle=`rgba(${s}, ${r}, ${l}, ${p})`,e.fillRect(c.x-o/2,c.y-o/2,o,o)})}function kt(){const e=L(),{image:t,width:n,height:o}=$(),[c,s]=I(),r=W(),[l,p]=P(),[a]=H(),[,h]=O(),[u,f]=i.exports.useState(3),m=i.exports.useRef(null),g=i.exports.useRef(null),b=c==="Mosaic",N=i.exports.useCallback(()=>{s.set("Mosaic"),h.set("crosshair")},[s,h]),S=i.exports.useCallback(()=>{b||(N(),p.clearSelect())},[b,N,p]),C=i.exports.useCallback(d=>{if(!b||g.current||!m.current||!r.current)return;const y=r.current.canvas.getBoundingClientRect(),k=d.clientX-y.x,w=d.clientY-y.y,E=u*2;g.current={name:"Mosaic",type:j.Source,data:{size:E,tiles:[{x:k,y:w,color:xe(k,w,m.current)}]},editHistory:[],draw:Nt}},[b,u,r]),z=i.exports.useCallback(d=>{if(!b||!g.current||!r.current||!m.current)return;const y=r.current.canvas.getBoundingClientRect(),k=d.clientX-y.x,w=d.clientY-y.y,E=g.current.data.size,D=g.current.data.tiles;let R=D[D.length-1];if(!R)D.push({x:k,y:w,color:xe(k,w,m.current)});else{const J=R.x-k,B=R.y-w;let V=Math.sqrt(J**2+B**2);const ge=-B/V,ve=-J/V;for(;V>E;){const re=Math.floor(R.x+E*ve),ne=Math.floor(R.y+E*ge);R={x:re,y:ne,color:xe(re,ne,m.current)},D.push(R),V-=E}V>E/2&&D.push({x:k,y:w,color:xe(k,w,m.current)})}l.top!==g.current?p.push(g.current):p.set(l)},[b,r,l,p]),x=i.exports.useCallback(()=>{!b||(g.current=null)},[b]);return ee(C),te(z),se(x),i.exports.useEffect(()=>{if(!a||!t||!b)return;const d=document.createElement("canvas"),y=d.getContext("2d");if(!y)return;d.width=a.width,d.height=a.height;const k=t.naturalWidth/n,w=t.naturalHeight/o;y.drawImage(t,a.x*k,a.y*w,a.width*k,a.height*w,0,0,a.width,a.height),m.current=y.getImageData(0,0,a.width,a.height)},[n,o,a,t,b]),v.exports.jsxDEV(X,{title:e.operation_mosaic_title,icon:"icon-mosaic",checked:b,onClick:S,option:v.exports.jsxDEV($e,{value:u,onChange:f},void 0,!1,{fileName:Le,lineNumber:220,columnNumber:15},this)},void 0,!1,{fileName:Le,lineNumber:215,columnNumber:5},this)}var Pe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsColor/index.tsx";function Ct({value:e,onChange:t}){const n=["#ee5126","#fceb4d","#90e746","#51c0fa","#7a7a7a","#ffffff"];return v.exports.jsxDEV("div",{className:"screenshots-color",children:n.map(o=>{const c=["screenshots-color-item"];return o===e&&c.push("screenshots-color-active"),v.exports.jsxDEV("div",{className:c.join(" "),style:{backgroundColor:o},onClick:()=>t&&t(o)},o,!1,{fileName:Pe,lineNumber:19,columnNumber:11},this)})},void 0,!1,{fileName:Pe,lineNumber:12,columnNumber:5},this)}var we="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsSizeColor/index.tsx";function ie({size:e,color:t,onSizeChange:n,onColorChange:o}){return v.exports.jsxDEV("div",{className:"screenshots-sizecolor",children:[v.exports.jsxDEV($e,{value:e,onChange:n},void 0,!1,{fileName:we,lineNumber:16,columnNumber:7},this),v.exports.jsxDEV(Ct,{value:t,onChange:o},void 0,!1,{fileName:we,lineNumber:17,columnNumber:7},this)]},void 0,!0,{fileName:we,lineNumber:15,columnNumber:5},this)}const Rt=`
min-width: 0 !important;
width: 0 !important;
min-height: 0 !important;
height:0 !important;
visibility: hidden !important;
overflow: hidden !important;
position: absolute !important;
z-index: -1000 !important;
top:0 !important;
right:0 !important;
`,wt=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","text-indent","padding-left","padding-right","border-width","box-sizing","white-space","word-break"];let U;function St(e){const t=window.getComputedStyle(e),n=t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),o=parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),c=parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width"));return{sizingStyle:wt.map(r=>`${r}:${t.getPropertyValue(r)}`).join(";"),paddingSize:o,borderSize:c,boxSizing:n}}function Dt(e,t,n,o){U||(U=document.createElement("textarea"),U.setAttribute("tab-index","-1"),document.body.appendChild(U));const{paddingSize:c,borderSize:s,boxSizing:r,sizingStyle:l}=St(e);U.setAttribute("style",`${l};${Rt};max-width:${n}px;max-height:${o}px`),U.value=t||" ";let p=U.scrollWidth,a=U.scrollHeight;return r==="border-box"?(p+=s,a+=s):r==="content-box"&&(p-=c,a-=c),{width:Math.min(p,n),height:Math.min(a,o)}}var zt="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsTextarea/index.tsx";function Et({x:e,y:t,maxWidth:n,maxHeight:o,size:c,color:s,value:r,onChange:l,onBlur:p}){const a=i.exports.useRef(null),h=i.exports.useRef(null),[u,f]=i.exports.useState(0),[m,g]=i.exports.useState(0),b=()=>(a.current||(a.current=document.createElement("div")),a.current);return i.exports.useLayoutEffect(()=>(a.current&&(document.body.appendChild(a.current),requestAnimationFrame(()=>{var N;(N=h.current)==null||N.focus()})),()=>{var N;(N=a.current)==null||N.remove()}),[]),i.exports.useLayoutEffect(()=>{if(!h.current)return;const{width:N,height:S}=Dt(h.current,r,n,o);f(N),g(S)},[r,n,o]),_e.exports.createPortal(v.exports.jsxDEV("textarea",{ref:h,className:"screenshots-textarea",style:{left:e,top:t,color:s,width:u,height:m,maxWidth:n,maxHeight:o,fontSize:c,lineHeight:`${c}px`},value:r,onChange:N=>l&&l(N.target.value),onBlur:N=>p&&p(N)},void 0,!1,{fileName:zt,lineNumber:65,columnNumber:5},this),b())}function le(e){const t=Z();i.exports.useEffect(()=>(t.on("drawselect",e),()=>{t.off("drawselect",e)}),[e,t])}var Se="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Text/index.tsx";const De={3:18,6:32,9:46};function jt(e,t){const{size:n,color:o,fontFamily:c,x:s,y:r,text:l}=t.data;e.fillStyle=o,e.textAlign="left",e.textBaseline="top",e.font=`${n}px ${c}`;const p=t.editHistory.reduce((a,{data:h})=>({x:a.x+h.x2-h.x1,y:a.y+h.y2-h.y1}),{x:0,y:0});l.split(`
`).forEach((a,h)=>{e.fillText(a,s+p.x,r+p.y+h*n)})}function Bt(e,t,n){e.textAlign="left",e.textBaseline="top",e.font=`${t.data.size}px ${t.data.fontFamily}`;let o=0,c=0;t.data.text.split(`
`).forEach(u=>{const f=e.measureText(u);o<f.width&&(o=f.width),c+=t.data.size});const{x:s,y:r}=t.editHistory.reduce((u,{data:f})=>({x:u.x+f.x2-f.x1,y:u.y+f.y2-f.y1}),{x:0,y:0}),l=t.data.x+s,p=t.data.y+r,a=l+o,h=p+c;return n.x>=l&&n.x<=a&&n.y>=p&&n.y<=h}function Mt(){const e=L(),[t,n]=P(),[o]=H(),[c,s]=I(),[,r]=O(),l=W(),[p,a]=i.exports.useState(3),[h,u]=i.exports.useState("#ee5126"),f=i.exports.useRef(null),m=i.exports.useRef(null),[g,b]=i.exports.useState(null),[N,S]=i.exports.useState(""),C=c==="Text",z=i.exports.useCallback(()=>{s.set("Text"),r.set("default")},[s,r]),x=i.exports.useCallback(()=>{C||(z(),n.clearSelect())},[C,z,n]),d=i.exports.useCallback(B=>{f.current&&(f.current.data.size=De[B]),a(B)},[]),y=i.exports.useCallback(B=>{f.current&&(f.current.data.color=B),u(B)},[]),k=i.exports.useCallback(B=>{S(B),C&&f.current&&(f.current.data.text=B)},[C]),w=i.exports.useCallback(()=>{f.current&&f.current.data.text&&n.push(f.current),f.current=null,S(""),b(null)},[n]),E=i.exports.useCallback((B,V)=>{B.name==="Text"&&(z(),m.current={type:j.Edit,data:{x1:V.clientX,y1:V.clientY,x2:V.clientX,y2:V.clientY},source:B},n.select(B))},[z,n]),D=i.exports.useCallback(B=>{if(!C||!l.current||f.current||!o)return;const{left:V,top:ge}=l.current.canvas.getBoundingClientRect(),ve=window.getComputedStyle(l.current.canvas).fontFamily,re=B.clientX-V,ne=B.clientY-ge;f.current={name:"Text",type:j.Source,data:{size:De[p],color:h,fontFamily:ve,x:re,y:ne,text:""},editHistory:[],draw:jt,isHit:Bt},b({x:B.clientX,y:B.clientY,maxWidth:o.width-re,maxHeight:o.height-ne})},[C,p,h,o,l]),R=i.exports.useCallback(B=>{!C||m.current&&(m.current.data.x2=B.clientX,m.current.data.y2=B.clientY,t.top!==m.current?(m.current.source.editHistory.push(m.current),n.push(m.current)):n.set(t))},[C,t,n]),J=i.exports.useCallback(()=>{!C||(m.current=null)},[C]);return le(E),ee(D),te(R),se(J),v.exports.jsxDEV(v.exports.Fragment,{children:[v.exports.jsxDEV(X,{title:e.operation_text_title,icon:"icon-text",checked:C,onClick:x,option:v.exports.jsxDEV(ie,{size:p,color:h,onSizeChange:d,onColorChange:y},void 0,!1,{fileName:Se,lineNumber:261,columnNumber:11},this)},void 0,!1,{fileName:Se,lineNumber:255,columnNumber:7},this),C&&g&&v.exports.jsxDEV(Et,{x:g.x,y:g.y,maxWidth:g.maxWidth,maxHeight:g.maxHeight,size:De[p],color:h,value:N,onChange:k,onBlur:w},void 0,!1,{fileName:Se,lineNumber:265,columnNumber:9},this)]},void 0,!0)}const Xe=4;function M(e,t,n){e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",e.beginPath(),e.arc(t,n,Xe,0,2*Math.PI),e.fill(),e.stroke()}function de(e,t,n){t.draw(e,t);const{data:o}=e.getImageData(n.x,n.y,1,1);return o.some(c=>c!==0)}function _(e,t,n){if(!e)return!1;const{left:o,top:c}=e.getBoundingClientRect(),s=t.clientX-o,r=t.clientY-c;return(n.x-s)**2+(n.y-r)**2<Xe**2}function _t(e,t){const{size:n,color:o,points:c}=t.data;e.lineCap="round",e.lineJoin="round",e.lineWidth=n,e.strokeStyle=o;const s=t.editHistory.reduce((r,{data:l})=>({x:r.x+l.x2-l.x1,y:r.y+l.y2-l.y1}),{x:0,y:0});e.beginPath(),c.forEach((r,l)=>{l===0?e.moveTo(r.x+s.x,r.y+s.y):e.lineTo(r.x+s.x,r.y+s.y)}),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.beginPath(),c.forEach((r,l)=>{l===0?e.moveTo(r.x+s.x,r.y+s.y):e.lineTo(r.x+s.x,r.y+s.y)}),e.stroke())}var Fe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Brush/index.tsx";function Vt(){const e=L(),[,t]=O(),[n,o]=I(),c=W(),[s,r]=P(),[l,p]=i.exports.useState(3),[a,h]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),f=i.exports.useRef(null),m=n==="Brush",g=i.exports.useCallback(()=>{o.set("Brush"),t.set("default")},[o,t]),b=i.exports.useCallback(()=>{m||(g(),r.clearSelect())},[m,g,r]),N=i.exports.useCallback((x,d)=>{x.name==="Brush"&&(g(),f.current={type:j.Edit,data:{x1:d.clientX,y1:d.clientY,x2:d.clientX,y2:d.clientY},source:x},r.select(x))},[g,r]),S=i.exports.useCallback(x=>{if(!m||u.current||!c.current)return;const{left:d,top:y}=c.current.canvas.getBoundingClientRect();u.current={name:"Brush",type:j.Source,data:{size:l,color:a,points:[{x:x.clientX-d,y:x.clientY-y}]},editHistory:[],draw:_t,isHit:de}},[m,c,l,a]),C=i.exports.useCallback(x=>{if(!(!m||!c.current)){if(f.current)f.current.data.x2=x.clientX,f.current.data.y2=x.clientY,s.top!==f.current?(f.current.source.editHistory.push(f.current),r.push(f.current)):r.set(s);else if(u.current){const{left:d,top:y}=c.current.canvas.getBoundingClientRect();u.current.data.points.push({x:x.clientX-d,y:x.clientY-y}),s.top!==u.current?r.push(u.current):r.set(s)}}},[m,s,c,r]),z=i.exports.useCallback(()=>{!m||(u.current&&r.clearSelect(),u.current=null,f.current=null)},[m,r]);return le(N),ee(S),te(C),se(z),v.exports.jsxDEV(X,{title:e.operation_brush_title,icon:"icon-brush",checked:m,onClick:b,option:v.exports.jsxDEV(ie,{size:l,color:a,onSizeChange:p,onColorChange:h},void 0,!1,{fileName:Fe,lineNumber:166,columnNumber:15},this)},void 0,!1,{fileName:Fe,lineNumber:161,columnNumber:5},this)}function Ye(e){let{x1:t,y1:n,x2:o,y2:c}=e.data;return e.editHistory.forEach(({data:s})=>{const r=s.x2-s.x1,l=s.y2-s.y1;s.type===ae.Move?(t+=r,n+=l,o+=r,c+=l):s.type===ae.MoveStart?(t+=r,n+=l):s.type===ae.MoveEnd&&(o+=r,c+=l)}),me(A({},e.data),{x1:t,x2:o,y1:n,y2:c})}function $t(e,t){const{size:n,color:o,x1:c,x2:s,y1:r,y2:l}=Ye(t);e.lineCap="round",e.lineJoin="bevel",e.lineWidth=n,e.strokeStyle=o;const p=s-c,a=l-r,h=n*3,u=Math.atan2(a,p);e.beginPath(),e.moveTo(c,r),e.lineTo(s,l),e.lineTo(s-h*Math.cos(u-Math.PI/6),l-h*Math.sin(u-Math.PI/6)),e.moveTo(s,l),e.lineTo(s-h*Math.cos(u+Math.PI/6),l-h*Math.sin(u+Math.PI/6)),e.stroke(),t.isSelected&&(M(e,c,r),M(e,s,l))}var Te="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Arrow/index.tsx",ae;(function(e){e[e.Move=0]="Move",e[e.MoveStart=1]="MoveStart",e[e.MoveEnd=2]="MoveEnd"})(ae||(ae={}));function Lt(){const e=L(),[,t]=O(),[n,o]=I(),[c,s]=P(),r=W(),[l,p]=i.exports.useState(3),[a,h]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),f=i.exports.useRef(null),m=n==="Arrow",g=i.exports.useCallback(()=>{o.set("Arrow"),t.set("default")},[o,t]),b=i.exports.useCallback(()=>{m||(g(),s.clearSelect())},[m,g,s]),N=i.exports.useCallback((x,d)=>{if(x.name!=="Arrow"||!r.current)return;const y=x;g();const{x1:k,y1:w,x2:E,y2:D}=Ye(y);let R=0;_(r.current.canvas,d,{x:k,y:w})?R=1:_(r.current.canvas,d,{x:E,y:D})&&(R=2),f.current={type:j.Edit,data:{type:R,x1:d.clientX,y1:d.clientY,x2:d.clientX,y2:d.clientY},source:y},s.select(x)},[r,g,s]),S=i.exports.useCallback(x=>{if(!m||u.current||!r.current)return;const{left:d,top:y}=r.current.canvas.getBoundingClientRect();u.current={name:"Arrow",type:j.Source,data:{size:l,color:a,x1:x.clientX-d,y1:x.clientY-y,x2:x.clientX-d,y2:x.clientY-y},editHistory:[],draw:$t,isHit:de}},[m,a,l,r]),C=i.exports.useCallback(x=>{if(!(!m||!r.current)){if(f.current)f.current.data.x2=x.clientX,f.current.data.y2=x.clientY,c.top!==f.current?(f.current.source.editHistory.push(f.current),s.push(f.current)):s.set(c);else if(u.current){const{left:d,top:y}=r.current.canvas.getBoundingClientRect();u.current.data.x2=x.clientX-d,u.current.data.y2=x.clientY-y,c.top!==u.current?s.push(u.current):s.set(c)}}},[m,c,r,s]),z=i.exports.useCallback(()=>{!m||(u.current&&s.clearSelect(),u.current=null,f.current=null)},[m,s]);return le(N),ee(S),te(C),se(z),v.exports.jsxDEV(X,{title:e.operation_arrow_title,icon:"icon-arrow",checked:m,onClick:b,option:v.exports.jsxDEV(ie,{size:l,color:a,onSizeChange:p,onColorChange:h},void 0,!1,{fileName:Te,lineNumber:190,columnNumber:15},this)},void 0,!1,{fileName:Te,lineNumber:185,columnNumber:5},this)}function Ae(e){let{x1:t,y1:n,x2:o,y2:c}=e.data;return e.editHistory.forEach(({data:s})=>{const r=s.x2-s.x1,l=s.y2-s.y1;s.type===F.Move?(t+=r,n+=l,o+=r,c+=l):s.type===F.ResizeTop?n+=l:s.type===F.ResizeRightTop?(o+=r,n+=l):s.type===F.ResizeRight?o+=r:s.type===F.ResizeRightBottom?(o+=r,c+=l):s.type===F.ResizeBottom?c+=l:s.type===F.ResizeLeftBottom?(t+=r,c+=l):s.type===F.ResizeLeft?t+=r:s.type===F.ResizeLeftTop&&(t+=r,n+=l)}),me(A({},e.data),{x1:t,x2:o,y1:n,y2:c})}function Pt(e,t){const{size:n,color:o,x1:c,y1:s,x2:r,y2:l}=Ae(t);e.lineCap="butt",e.lineJoin="miter",e.lineWidth=n,e.strokeStyle=o;const p=(c+r)/2,a=(s+l)/2,h=Math.abs(r-c)/2,u=Math.abs(l-s)/2,f=.5522848,m=h*f,g=u*f;e.beginPath(),e.moveTo(p-h,a),e.bezierCurveTo(p-h,a-g,p-m,a-u,p,a-u),e.bezierCurveTo(p+m,a-u,p+h,a-g,p+h,a),e.bezierCurveTo(p+h,a+g,p+m,a+u,p,a+u),e.bezierCurveTo(p-m,a+u,p-h,a+g,p-h,a),e.closePath(),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",e.beginPath(),e.moveTo(c,s),e.lineTo(r,s),e.lineTo(r,l),e.lineTo(c,l),e.closePath(),e.stroke(),M(e,(c+r)/2,s),M(e,r,s),M(e,r,(s+l)/2),M(e,r,l),M(e,(c+r)/2,l),M(e,c,l),M(e,c,(s+l)/2),M(e,c,s))}var He="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Ellipse/index.tsx",F;(function(e){e[e.Move=0]="Move",e[e.ResizeTop=1]="ResizeTop",e[e.ResizeRightTop=2]="ResizeRightTop",e[e.ResizeRight=3]="ResizeRight",e[e.ResizeRightBottom=4]="ResizeRightBottom",e[e.ResizeBottom=5]="ResizeBottom",e[e.ResizeLeftBottom=6]="ResizeLeftBottom",e[e.ResizeLeft=7]="ResizeLeft",e[e.ResizeLeftTop=8]="ResizeLeftTop"})(F||(F={}));function Xt(){const e=L(),[t,n]=P(),[o,c]=I(),[,s]=O(),r=W(),[l,p]=i.exports.useState(3),[a,h]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),f=i.exports.useRef(null),m=o==="Ellipse",g=i.exports.useCallback(()=>{c.set("Ellipse"),s.set("crosshair")},[c,s]),b=i.exports.useCallback(()=>{m||(g(),n.clearSelect())},[m,g,n]),N=i.exports.useCallback((x,d)=>{if(x.name!=="Ellipse"||!r.current)return;const y=x;g();const{x1:k,y1:w,x2:E,y2:D}=Ae(y);let R=0;_(r.current.canvas,d,{x:(k+E)/2,y:w})?R=1:_(r.current.canvas,d,{x:E,y:w})?R=2:_(r.current.canvas,d,{x:E,y:(w+D)/2})?R=3:_(r.current.canvas,d,{x:E,y:D})?R=4:_(r.current.canvas,d,{x:(k+E)/2,y:D})?R=5:_(r.current.canvas,d,{x:k,y:D})?R=6:_(r.current.canvas,d,{x:k,y:(w+D)/2})?R=7:_(r.current.canvas,d,{x:k,y:w})&&(R=8),f.current={type:j.Edit,data:{type:R,x1:d.clientX,y1:d.clientY,x2:d.clientX,y2:d.clientY},source:y},n.select(x)},[r,g,n]),S=i.exports.useCallback(x=>{if(!m||!r.current||u.current)return;const{left:d,top:y}=r.current.canvas.getBoundingClientRect(),k=x.clientX-d,w=x.clientY-y;u.current={name:"Ellipse",type:j.Source,data:{size:l,color:a,x1:k,y1:w,x2:k,y2:w},editHistory:[],draw:Pt,isHit:de}},[m,l,a,r]),C=i.exports.useCallback(x=>{if(!(!m||!r.current)){if(f.current)f.current.data.x2=x.clientX,f.current.data.y2=x.clientY,t.top!==f.current?(f.current.source.editHistory.push(f.current),n.push(f.current)):n.set(t);else if(u.current){const{left:d,top:y}=r.current.canvas.getBoundingClientRect();u.current.data.x2=x.clientX-d,u.current.data.y2=x.clientY-y,t.top!==u.current?n.push(u.current):n.set(t)}}},[m,r,t,n]),z=i.exports.useCallback(()=>{!m||(u.current&&n.clearSelect(),u.current=null,f.current=null)},[m,n]);return le(N),ee(S),te(C),se(z),v.exports.jsxDEV(X,{title:e.operation_ellipse_title,icon:"icon-ellipse",checked:m,onClick:b,option:v.exports.jsxDEV(ie,{size:l,color:a,onSizeChange:p,onColorChange:h},void 0,!1,{fileName:He,lineNumber:242,columnNumber:15},this)},void 0,!1,{fileName:He,lineNumber:237,columnNumber:5},this)}function Oe(e){let{x1:t,y1:n,x2:o,y2:c}=e.data;return e.editHistory.forEach(({data:s})=>{const r=s.x2-s.x1,l=s.y2-s.y1;s.type===Y.Move?(t+=r,n+=l,o+=r,c+=l):s.type===Y.ResizeTop?n+=l:s.type===Y.ResizeRightTop?(o+=r,n+=l):s.type===Y.ResizeRight?o+=r:s.type===Y.ResizeRightBottom?(o+=r,c+=l):s.type===Y.ResizeBottom?c+=l:s.type===Y.ResizeLeftBottom?(t+=r,c+=l):s.type===Y.ResizeLeft?t+=r:s.type===Y.ResizeLeftTop&&(t+=r,n+=l)}),me(A({},e.data),{x1:t,x2:o,y1:n,y2:c})}function Ft(e,t){const{size:n,color:o,x1:c,y1:s,x2:r,y2:l}=Oe(t);e.lineCap="butt",e.lineJoin="miter",e.lineWidth=n,e.strokeStyle=o,e.beginPath(),e.moveTo(c,s),e.lineTo(r,s),e.lineTo(r,l),e.lineTo(c,l),e.closePath(),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",M(e,(c+r)/2,s),M(e,r,s),M(e,r,(s+l)/2),M(e,r,l),M(e,(c+r)/2,l),M(e,c,l),M(e,c,(s+l)/2),M(e,c,s))}var Ie="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/operations/Rectangle/index.tsx",Y;(function(e){e[e.Move=0]="Move",e[e.ResizeTop=1]="ResizeTop",e[e.ResizeRightTop=2]="ResizeRightTop",e[e.ResizeRight=3]="ResizeRight",e[e.ResizeRightBottom=4]="ResizeRightBottom",e[e.ResizeBottom=5]="ResizeBottom",e[e.ResizeLeftBottom=6]="ResizeLeftBottom",e[e.ResizeLeft=7]="ResizeLeft",e[e.ResizeLeftTop=8]="ResizeLeftTop"})(Y||(Y={}));function Yt(){const e=L(),[t,n]=P(),[o,c]=I(),[,s]=O(),r=W(),[l,p]=i.exports.useState(3),[a,h]=i.exports.useState("#ee5126"),u=i.exports.useRef(null),f=i.exports.useRef(null),m=o==="Rectangle",g=i.exports.useCallback(()=>{c.set("Rectangle"),s.set("crosshair")},[c,s]),b=i.exports.useCallback(()=>{m||(g(),n.clearSelect())},[m,g,n]),N=i.exports.useCallback((x,d)=>{if(x.name!=="Rectangle"||!r.current)return;const y=x;g();const{x1:k,y1:w,x2:E,y2:D}=Oe(y);let R=0;_(r.current.canvas,d,{x:(k+E)/2,y:w})?R=1:_(r.current.canvas,d,{x:E,y:w})?R=2:_(r.current.canvas,d,{x:E,y:(w+D)/2})?R=3:_(r.current.canvas,d,{x:E,y:D})?R=4:_(r.current.canvas,d,{x:(k+E)/2,y:D})?R=5:_(r.current.canvas,d,{x:k,y:D})?R=6:_(r.current.canvas,d,{x:k,y:(w+D)/2})?R=7:_(r.current.canvas,d,{x:k,y:w})&&(R=8),f.current={type:j.Edit,data:{type:R,x1:d.clientX,y1:d.clientY,x2:d.clientX,y2:d.clientY},source:x},n.select(x)},[r,g,n]),S=i.exports.useCallback(x=>{if(!m||!r.current||u.current)return;const{left:d,top:y}=r.current.canvas.getBoundingClientRect(),k=x.clientX-d,w=x.clientY-y;u.current={name:"Rectangle",type:j.Source,data:{size:l,color:a,x1:k,y1:w,x2:k,y2:w},editHistory:[],draw:Ft,isHit:de}},[m,l,a,r]),C=i.exports.useCallback(x=>{if(!(!m||!r.current)){if(f.current)f.current.data.x2=x.clientX,f.current.data.y2=x.clientY,t.top!==f.current?(f.current.source.editHistory.push(f.current),n.push(f.current)):n.set(t);else if(u.current){const{left:d,top:y}=r.current.canvas.getBoundingClientRect(),k=u.current.data;k.x2=x.clientX-d,k.y2=x.clientY-y,t.top!==u.current?n.push(u.current):n.set(t)}}},[m,r,t,n]),z=i.exports.useCallback(()=>{!m||(u.current&&n.clearSelect(),u.current=null,f.current=null)},[m,n]);return le(N),ee(S),te(C),se(z),v.exports.jsxDEV(X,{title:e.operation_rectangle_title,icon:"icon-rectangle",checked:m,onClick:b,option:v.exports.jsxDEV(ie,{size:l,color:a,onSizeChange:p,onColorChange:h},void 0,!1,{fileName:Ie,lineNumber:242,columnNumber:15},this)},void 0,!1,{fileName:Ie,lineNumber:237,columnNumber:5},this)}var Tt=[Yt,Xt,Lt,Vt,Mt,kt,"|",yt,vt,"|",dt,pt,ht];var ue="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsOperations/index.tsx";const We=Me.createContext(null);function At(){const{width:e,height:t}=$(),[n]=H(),[o,c]=i.exports.useState(null),[s,r]=i.exports.useState(null),l=i.exports.useRef(null),p=i.exports.useCallback(h=>{h.stopPropagation()},[]),a=i.exports.useCallback(h=>{h.preventDefault(),h.stopPropagation()},[]);return i.exports.useEffect(()=>{if(!n||!l.current)return;const h=l.current.getBoundingClientRect();let u=n.x+n.width-h.width,f=n.y+n.height+10;u<0&&(u=0),u>e-h.width&&(u=e-h.width),f>t-h.height&&(f=t-h.height-10),((s==null?void 0:s.x)!==u||s.y!==f)&&r({x:u,y:f}),((o==null?void 0:o.x)!==h.x||o.y!==h.y||o.width!==h.width||o.height!==h.height)&&c({x:h.x,y:h.y,width:h.width,height:h.height})}),n?v.exports.jsxDEV(We.Provider,{value:o,children:v.exports.jsxDEV("div",{ref:l,className:"screenshots-operations",style:{visibility:s?"visible":"hidden",left:s==null?void 0:s.x,top:s==null?void 0:s.y},onDoubleClick:p,onContextMenu:a,children:v.exports.jsxDEV("div",{className:"screenshots-operations-buttons",children:Tt.map((h,u)=>h==="|"?v.exports.jsxDEV("div",{className:"screenshots-operations-divider"},u,!1,{fileName:ue,lineNumber:91,columnNumber:22},this):v.exports.jsxDEV(h,{},u,!1,{fileName:ue,lineNumber:93,columnNumber:22},this))},void 0,!1,{fileName:ue,lineNumber:88,columnNumber:9},this)},void 0,!1,{fileName:ue,lineNumber:77,columnNumber:7},this)},void 0,!1,{fileName:ue,lineNumber:76,columnNumber:5},this):null}function Ht(e){const[t,n]=i.exports.useState(null);return i.exports.useEffect(()=>{if(n(null),e==null)return;const o=document.createElement("img"),c=()=>n(o),s=()=>n(null);return o.addEventListener("load",c),o.addEventListener("error",s),o.src=e,()=>{o.removeEventListener("load",c),o.removeEventListener("error",s)}},[e]),t}var fe="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/Screenshots/index.tsx";function Ot(r){var l=r,{url:e,width:t,height:n,lang:o,className:c}=l,s=Be(l,["url","width","height","lang","className"]);const p=Ht(e),a=i.exports.useRef(null),h=i.exports.useRef({}),[u,f]=i.exports.useState({index:-1,stack:[]}),[m,g]=i.exports.useState(null),[b,N]=i.exports.useState("move"),[S,C]=i.exports.useState(void 0),z={url:e,width:t,height:n,image:p,lang:A(A({},Ve),o),emiterRef:h,canvasContextRef:a,history:u,bounds:m,cursor:b,operation:S},x=i.exports.useCallback((D,...R)=>{const J=s[D];typeof J=="function"&&J(...R)},[s]),d={call:x,setHistory:f,setBounds:g,setCursor:N,setOperation:C},y=["screenshots"];c&&y.push(c);const k=()=>{h.current={},f({index:-1,stack:[]}),g(null),N("move"),C(void 0)},w=i.exports.useCallback(async D=>{if(!(D.button!==0||!p))if(m&&a.current)a.current.canvas.toBlob(R=>{x("onOk",R,m),k()},"image/png");else{const R=await et(p,{width:t,height:n});x("onOk",R,{x:0,y:0,width:t,height:n}),k()}},[p,m,t,n,x]),E=i.exports.useCallback(D=>{D.button===2&&(D.preventDefault(),x("onCancel"),k())},[x]);return i.exports.useLayoutEffect(()=>{k()},[e]),v.exports.jsxDEV(be.Provider,{value:{store:z,dispatcher:d},children:v.exports.jsxDEV("div",{className:y.join(" "),style:{width:t,height:n},onDoubleClick:w,onContextMenu:E,children:[v.exports.jsxDEV(rt,{},void 0,!1,{fileName:fe,lineNumber:135,columnNumber:9},this),v.exports.jsxDEV(at,{ref:a},void 0,!1,{fileName:fe,lineNumber:136,columnNumber:9},this),v.exports.jsxDEV(At,{},void 0,!1,{fileName:fe,lineNumber:137,columnNumber:9},this)]},void 0,!0,{fileName:fe,lineNumber:129,columnNumber:7},this)},void 0,!1,{fileName:fe,lineNumber:128,columnNumber:5},this)}var It="./assets/image.82ad6a18.png",Ue="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/web/app.tsx";function Wt(){const e=i.exports.useCallback((o,c)=>{console.log("save",o,c),console.log(o&&URL.createObjectURL(o))},[]),t=i.exports.useCallback(()=>{console.log("cancel")},[]),n=i.exports.useCallback((o,c)=>{console.log("ok",o,c),console.log(o&&URL.createObjectURL(o))},[]);return v.exports.jsxDEV("div",{className:"body",children:v.exports.jsxDEV(Ot,{url:It,width:window.innerWidth,height:window.innerHeight,lang:{operation_rectangle_title:"Rectangle"},onSave:e,onCancel:t,onOk:n},void 0,!1,{fileName:Ue,lineNumber:22,columnNumber:7},this)},void 0,!1,{fileName:Ue,lineNumber:21,columnNumber:5},this)}var Je="/home/runner/work/screenshots/screenshots/packages/react-screenshots/src/web/index.tsx";Ke.render(v.exports.jsxDEV(i.exports.StrictMode,{children:v.exports.jsxDEV(Wt,{},void 0,!1,{fileName:Je,lineNumber:7,columnNumber:5},globalThis)},void 0,!1,{fileName:Je,lineNumber:6,columnNumber:3},globalThis),document.getElementById("app"));
